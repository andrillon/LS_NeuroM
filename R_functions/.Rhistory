library(lmerTest)
library(multilevelTools)
library(ggstance)
library(jtools)
library(broom.mixed)
library(sjPlot)
library(glmmTMB)
library(lattice)
library(arm)
library(plyr)
library(Rmisc)
CTET_Behaviour <- read.table("../Tables/CTET_behav_res.txt", header = TRUE, sep = ",", stringsAsFactors = FALSE)
CTET_Behaviour$SubID<-as.factor(CTET_Behaviour$SubID)
CTET_Behaviour$Treatment<-as.factor(CTET_Behaviour$Treatment)
CTET_Behaviour<-CTET_Behaviour[as.numeric(CTET_Behaviour$BlockN)<11,]
CTET_Behaviour$BlockN<-as.numeric(CTET_Behaviour$BlockN)
CTET_Behaviour$Treatment<-ordered(CTET_Behaviour$Treatment,c("PLA","MPH","ATM","CIT"))
CTET_Behaviour<-CTET_Behaviour[!is.na(CTET_Behaviour$BlockN),]
##False Alarm
aggdata_FA<-aggregate(CTET_Behaviour$FA, list(SubID=CTET_Behaviour$SubID,BlockN=CTET_Behaviour$BlockN,Treatment=CTET_Behaviour$Treatment), mean,na.rm=TRUE)
colnames(aggdata_FA) = c("SubID","BlockN", "Treatment","FA")
lm.FA0 <- lmer(FA ~ 1 + (1|SubID), data = aggdata_FA, REML = TRUE)
##Effects of treatment on false alarms
lm.FA1 <- lmer(FA ~ 1 + Treatment + (1|SubID), data = aggdata_FA, REML = TRUE)
#Added effects of block number on false alarm
lm.FA2 <- lmer(FA ~ 1 + Treatment + BlockN + (1|SubID), data = aggdata_FA, REML = TRUE)
#Added effects of block number as an interaction on false alarm
lm.FA3 <- lmer(FA ~ 1 + Treatment * BlockN + (1|SubID), data = aggdata_FA, REML = TRUE)
##Anova to see which one has the most interaction
anova(lm.FA0,lm.FA1,lm.FA2,lm.FA3)
summary(lm.FA2)
confint(lm.FA2, method = "Wald", oldNames = FALSE)
## Normality plot of residuals - TA: Try to plot QQ plots
hist(residuals(lm.FA2))
qqnorm(resid(lm.FA2))
qqline(resid(lm.FA2))
plot(lm.FA2)
plot(fitted(lm.FA2), resid(lm.FA2))
summary(lm.FA2)
View(CTET_Behaviour)
View(CTET_Behaviour)
library(ggplot2)
library(ggpubr)
library(car)
library(haven)
library(data.table)
library(visreg)
library(dplyr)
library(tidyr)
library(reshape2)
library(rstatix)
library(JWileymisc)
library(lme4)
library(lmerTest)
library(multilevelTools)
library(ggstance)
library(jtools)
library(broom.mixed)
library(sjPlot)
library(glmmTMB)
library(lattice)
library(arm)
library(plyr)
library(Rmisc)
CTET_Behaviour <- read.table("../Tables/CTET_behav_res.txt", header = TRUE, sep = ",", stringsAsFactors = FALSE)
CTET_Behaviour$SubID<-as.factor(CTET_Behaviour$SubID)
CTET_Behaviour$Treatment<-as.factor(CTET_Behaviour$Treatment,c("PLA","MPH","ATM","CIT"))
##False Alarm
aggdata_FA<-aggregate(CTET_Behaviour$FA, list(SubID=CTET_Behaviour$SubID,BlockN=CTET_Behaviour$BlockN,Treatment=CTET_Behaviour$Treatment), mean,na.rm=TRUE)
colnames(aggdata_FA) = c("SubID","BlockN", "Treatment","FA")
lm.FA0 <- lmer(FA ~ 1 + (1|SubID), data = aggdata_FA, REML = TRUE)
##Effects of treatment on false alarms
lm.FA1 <- lmer(FA ~ 1 + Treatment + (1|SubID), data = aggdata_FA, REML = TRUE)
#Added effects of block number on false alarm
lm.FA2 <- lmer(FA ~ 1 + Treatment + BlockN + (1|SubID), data = aggdata_FA, REML = TRUE)
#Added effects of block number as an interaction on false alarm
lm.FA3 <- lmer(FA ~ 1 + Treatment * BlockN + (1|SubID), data = aggdata_FA, REML = TRUE)
##Anova to see which one has the most interaction
anova(lm.FA0,lm.FA1,lm.FA2,lm.FA3)
summary(lm.FA2)
confint(lm.FA2, method = "Wald", oldNames = FALSE)
## Normality plot of residuals - TA: Try to plot QQ plots
hist(residuals(lm.FA2))
qqnorm(resid(lm.FA2))
qqline(resid(lm.FA2))
plot(lm.FA2)
plot(fitted(lm.FA2), resid(lm.FA2))
summary(lm.FA2)
CTET_Behaviour$Treatment<-as.factor(CTET_Behaviour$Treatment,levels=c("PLA","MPH","ATM","CIT"))
CTET_Behaviour$Treatment<-as.factor(CTET_Behaviour$Treatment)
CTET_Behaviour$Treatment<-ordered(CTET_Behaviour$Treatment,c("PLA","MPH","ATM","CIT"))
CTET_Behaviour$Treatment<-relevel(CTET_Behaviour$Treatment,"PLA")
library(ggplot2)
library(ggpubr)
library(car)
library(haven)
library(data.table)
library(visreg)
library(dplyr)
library(tidyr)
library(reshape2)
library(rstatix)
library(JWileymisc)
library(lme4)
library(lmerTest)
library(multilevelTools)
library(ggstance)
library(jtools)
library(broom.mixed)
library(sjPlot)
library(glmmTMB)
library(lattice)
library(arm)
library(plyr)
library(Rmisc)
CTET_Behaviour <- read.table("../Tables/CTET_behav_res.txt", header = TRUE, sep = ",", stringsAsFactors = FALSE)
CTET_Behaviour$SubID<-as.factor(CTET_Behaviour$SubID)
CTET_Behaviour$Treatment<-as.factor(CTET_Behaviour$Treatment)
CTET_Behaviour<-CTET_Behaviour[as.numeric(CTET_Behaviour$BlockN)<11,]
CTET_Behaviour$BlockN<-as.numeric(CTET_Behaviour$BlockN)
CTET_Behaviour$Treatment<-relevel(CTET_Behaviour$Treatment,"PLA")
CTET_Behaviour<-CTET_Behaviour[!is.na(CTET_Behaviour$BlockN),]
##False Alarm
aggdata_FA<-aggregate(CTET_Behaviour$FA, list(SubID=CTET_Behaviour$SubID,BlockN=CTET_Behaviour$BlockN,Treatment=CTET_Behaviour$Treatment), mean,na.rm=TRUE)
colnames(aggdata_FA) = c("SubID","BlockN", "Treatment","FA")
lm.FA0 <- lmer(FA ~ 1 + (1|SubID), data = aggdata_FA, REML = TRUE)
##Effects of treatment on false alarms
lm.FA1 <- lmer(FA ~ 1 + Treatment + (1|SubID), data = aggdata_FA, REML = TRUE)
#Added effects of block number on false alarm
lm.FA2 <- lmer(FA ~ 1 + Treatment + BlockN + (1|SubID), data = aggdata_FA, REML = TRUE)
#Added effects of block number as an interaction on false alarm
lm.FA3 <- lmer(FA ~ 1 + Treatment * BlockN + (1|SubID), data = aggdata_FA, REML = TRUE)
##Anova to see which one has the most interaction
anova(lm.FA0,lm.FA1,lm.FA2,lm.FA3)
summary(lm.FA2)
confint(lm.FA2, method = "Wald", oldNames = FALSE)
## Normality plot of residuals - TA: Try to plot QQ plots
hist(residuals(lm.FA2))
qqnorm(resid(lm.FA2))
qqline(resid(lm.FA2))
plot(lm.FA2)
plot(fitted(lm.FA2), resid(lm.FA2))
summary(lm.FA2)
##Graph of the interaction between treatment and block number on false alarms
aggdata.fa<-aggregate(CTET_Behaviour$FA, list(BlockN=CTET_Behaviour$BlockN,Treatment=CTET_Behaviour$Treatment), mean,na.rm=TRUE)
colnames(aggdata.fa) = c("BlockN", "Treatment","FA")
fa.graph <- summarySE(aggdata_FA, measurevar = "FA", groupvars = c("BlockN", "Treatment"))
fa.graph$FA_mean<-fa.graph$FA
fa.graph$Treatment<-ordered(fa.graph$Treatment,c("PLA","MPH","ATM","CIT"))
##REFERENCE GRAPH
ggplot(aggdata.fa, aes(x = BlockN, y = FA, colour = Treatment)) + geom_point() + geom_line() + scale_colour_brewer(palette = "Dark2") + scale_fill_brewer(palette = "Dark2") + ggtitle("False alarms according to block number and treatment") + ylab("False Alarms") + xlab("Block Number") + xlim(0, 12) + ylim(0, 0.01)
##Graph with Standard Error
ggplot(fa.graph, aes(x = BlockN, y = FA_mean, colour = Treatment)) + geom_point() + geom_line() + scale_colour_brewer(palette = "Dark2") + scale_fill_brewer(palette = "Dark2") + ggtitle("False alarms according to block number and treatment") + ylab("Mean False Alarms") + xlab("Block Number") + xlim(0, 12) + ylim(0, 0.01) + geom_errorbar(aes(ymin = FA_mean-se, ymax = FA_mean+se), size = .4, width = .5, alpha = 1) + scale_colour_discrete(name = "Treatment", breaks = c("PLA", "MPH", "ATM", "CIT"), labels = c("Placebo", "Methylphenidate", "Atomoxetine", "Citalopram"))
##Barplot
fa2.graph <- summarySE(aggdata_FA, measurevar = "FA", groupvars = c( "Treatment"))
fa2.graph$FA_mean<-fa2.graph$FA
ggplot(data=fa2.graph, aes(x=Treatment, y=FA_mean, fill = Treatment)) +
geom_bar(stat="identity") + geom_errorbar(aes(ymin = FA_mean-se, ymax = FA_mean+se), width = .2, size = .3) + scale_fill_discrete( name = "Treatment", breaks = c("PLA", "MPH", "ATM", "CIT"), labels = c("Placebo", "Methylphenidate", "Atomoxetine", "Citalopram")) + ylab("Mean False Alarm")
##Graph of the interaction between treatment and block number on false alarms
aggdata.fa<-aggregate(CTET_Behaviour$FA, list(BlockN=CTET_Behaviour$BlockN,Treatment=CTET_Behaviour$Treatment), mean,na.rm=TRUE)
colnames(aggdata.fa) = c("BlockN", "Treatment","FA")
fa.graph <- summarySE(aggdata_FA, measurevar = "FA", groupvars = c("BlockN", "Treatment"))
fa.graph$FA_mean<-fa.graph$FA
fa.graph$Treatment<-ordered(fa.graph$Treatment,c("PLA","MPH","ATM","CIT"))
##REFERENCE GRAPH
ggplot(aggdata.fa, aes(x = BlockN, y = FA, colour = Treatment)) + geom_point() + geom_line() + scale_colour_brewer(palette = "Dark2") + scale_fill_brewer(palette = "Dark2") + ggtitle("False alarms according to block number and treatment") + ylab("False Alarms") + xlab("Block Number") + xlim(0, 12) + ylim(0, 0.01)
##Graph with Standard Error
ggplot(fa.graph, aes(x = BlockN, y = FA_mean, colour = Treatment)) + geom_point() + geom_line() + scale_colour_brewer(palette = "Dark2") + scale_fill_brewer(palette = "Dark2") + ggtitle("False alarms according to block number and treatment") + ylab("Mean False Alarms") + xlab("Block Number") + xlim(0, 12) + ylim(0, 0.01) + geom_errorbar(aes(ymin = FA_mean-se, ymax = FA_mean+se), size = .4, width = .5, alpha = 1) + scale_colour_discrete(name = "Treatment", breaks = c("PLA", "MPH", "ATM", "CIT"), labels = c("Placebo", "Methylphenidate", "Atomoxetine", "Citalopram"))
##Barplot
fa2.graph <- summarySE(aggdata_FA, measurevar = "FA", groupvars = c( "Treatment"))
fa2.graph$FA_mean<-fa2.graph$FA
fa2.graph$Treatment<-ordered(fa2.graph$Treatment,c("PLA","MPH","ATM","CIT"))
ggplot(data=fa2.graph, aes(x=Treatment, y=FA_mean, fill = Treatment)) +
geom_bar(stat="identity") + geom_errorbar(aes(ymin = FA_mean-se, ymax = FA_mean+se), width = .2, size = .3) + scale_fill_discrete( name = "Treatment", breaks = c("PLA", "MPH", "ATM", "CIT"), labels = c("Placebo", "Methylphenidate", "Atomoxetine", "Citalopram")) + ylab("Mean False Alarm")
aggdata_MISS<-aggregate(CTET_Behaviour$Miss, list(SubID=CTET_Behaviour$SubID,BlockN=CTET_Behaviour$BlockN,Treatment=CTET_Behaviour$Treatment), mean,na.rm=TRUE)
colnames(aggdata_MISS) = c("SubID","BlockN", "Treatment","Miss")
##Misses
lm.Miss0 <- lmer(Miss ~ 1 + (1|SubID), data = aggdata_MISS, REML = TRUE)
##Effects of treatment on misses
lm.Miss1 <- lmer(Miss ~ 1 + Treatment + (1|SubID), data =  aggdata_MISS, REML = TRUE)
##Added effects of block number on misses
lm.Miss2 <- lmer(Miss ~ 1 + Treatment + BlockN + (1|SubID), data =  aggdata_MISS, REML = TRUE)
##Added effects of block number as an interaction on misses
lm.Miss3 <- lmer(Miss ~ 1 + Treatment*BlockN + (1|SubID), data =  aggdata_MISS, REML = TRUE)
##Anova to see which one has the most interaction
anova(lm.Miss0,lm.Miss1,lm.Miss2,lm.Miss3)
summary(lm.Miss3)
confint(lm.Miss3, method = "Wald", oldNames = FALSE)
##Normality plot of residuals
hist(residuals(lm.Miss3))
boxplot(residuals(lm.Miss3))
qqnorm(resid(lm.Miss3))
qqline(resid(lm.Miss3))
plot(lm.Miss3)
plot(fitted(lm.Miss3), resid(lm.Miss3))
binnedplot(fitted(lm.Miss3),resid(lm.Miss3))
##Graph of the interaction between treatment and block number on missed targets
aggdata.miss<-aggregate(CTET_Behaviour$Miss, list(BlockN=CTET_Behaviour$BlockN,Treatment=CTET_Behaviour$Treatment), mean,na.rm=TRUE)
colnames(aggdata.miss) = c("BlockN", "Treatment","Miss")
miss.graph <- summarySE(aggdata_MISS, measurevar = "Miss", groupvars = c("BlockN", "Treatment"), na.rm = TRUE)
#check if it's okay that you removed NAs
##Reference graph
ggplot(aggdata.miss, aes(x = BlockN, y = Miss, colour = Treatment)) + geom_point() + geom_line() + scale_colour_brewer(palette = "Dark2") + scale_fill_brewer(palette = "Dark2") + ggtitle("Missed targets according to block number and treatment") + ylab("Missed Target") + xlab("Block Number") + xlim(0, 12) + ylim(0, 0.5)
##Graph with Standard Error
ggplot(miss.graph, aes(x = BlockN, y = Miss_mean, colour = Treatment)) + geom_point() + geom_line() + scale_colour_brewer(palette = "Dark2") + scale_fill_brewer(palette = "Dark2") + ggtitle("Missed targets according to block number and treatment") + ylab("Mean Missed Targets") + xlab("Block Number") + xlim(0, 11) + ylim(0.1, 0.5) + geom_errorbar(aes(ymin = Miss_mean-se, ymax = Miss_mean+se), size = .4, width = .5, alpha = .3) + scale_colour_discrete(name = "Treatment", breaks = c("PLA", "ATM", "CIT", "MPH"), labels = c("Placebo", "Atomoxetine", "Citalopram", "Methylphenidate"))
##Graph of the interaction between treatment and block number on missed targets
aggdata.miss<-aggregate(CTET_Behaviour$Miss, list(BlockN=CTET_Behaviour$BlockN,Treatment=CTET_Behaviour$Treatment), mean,na.rm=TRUE)
colnames(aggdata.miss) = c("BlockN", "Treatment","Miss")
miss.graph <- summarySE(aggdata_MISS, measurevar = "Miss", groupvars = c("BlockN", "Treatment"), na.rm = TRUE)
miss.graph$Miss_mean<-fa.graph$Miss
miss.graph$Treatment<-ordered(miss.graph$Treatment,c("PLA","MPH","ATM","CIT"))
#check if it's okay that you removed NAs
##Reference graph
ggplot(aggdata.miss, aes(x = BlockN, y = Miss, colour = Treatment)) + geom_point() + geom_line() + scale_colour_brewer(palette = "Dark2") + scale_fill_brewer(palette = "Dark2") + ggtitle("Missed targets according to block number and treatment") + ylab("Missed Target") + xlab("Block Number") + xlim(0, 12) + ylim(0, 0.5)
##Graph with Standard Error
ggplot(miss.graph, aes(x = BlockN, y = Miss_mean, colour = Treatment)) + geom_point() + geom_line() + scale_colour_brewer(palette = "Dark2") + scale_fill_brewer(palette = "Dark2") + ggtitle("Missed targets according to block number and treatment") + ylab("Mean Missed Targets") + xlab("Block Number") + xlim(0, 11) + ylim(0.1, 0.5) + geom_errorbar(aes(ymin = Miss_mean-se, ymax = Miss_mean+se), size = .4, width = .5, alpha = .3) + scale_colour_discrete(name = "Treatment", breaks = c("PLA", "ATM", "CIT", "MPH"), labels = c("Placebo", "Atomoxetine", "Citalopram", "Methylphenidate"))
##Graph of the interaction between treatment and block number on missed targets
aggdata.miss<-aggregate(CTET_Behaviour$Miss, list(BlockN=CTET_Behaviour$BlockN,Treatment=CTET_Behaviour$Treatment), mean,na.rm=TRUE)
colnames(aggdata.miss) = c("BlockN", "Treatment","Miss")
miss.graph <- summarySE(aggdata_MISS, measurevar = "Miss", groupvars = c("BlockN", "Treatment"), na.rm = TRUE)
miss.graph$Miss_mean<-miss.graph$Miss
miss.graph$Treatment<-ordered(miss.graph$Treatment,c("PLA","MPH","ATM","CIT"))
#check if it's okay that you removed NAs
##Reference graph
ggplot(aggdata.miss, aes(x = BlockN, y = Miss, colour = Treatment)) + geom_point() + geom_line() + scale_colour_brewer(palette = "Dark2") + scale_fill_brewer(palette = "Dark2") + ggtitle("Missed targets according to block number and treatment") + ylab("Missed Target") + xlab("Block Number") + xlim(0, 12) + ylim(0, 0.5)
##Graph with Standard Error
ggplot(miss.graph, aes(x = BlockN, y = Miss_mean, colour = Treatment)) + geom_point() + geom_line() + scale_colour_brewer(palette = "Dark2") + scale_fill_brewer(palette = "Dark2") + ggtitle("Missed targets according to block number and treatment") + ylab("Mean Missed Targets") + xlab("Block Number") + xlim(0, 11) + ylim(0.1, 0.5) + geom_errorbar(aes(ymin = Miss_mean-se, ymax = Miss_mean+se), size = .4, width = .5, alpha = .3) + scale_colour_discrete(name = "Treatment", breaks = c("PLA", "ATM", "CIT", "MPH"), labels = c("Placebo", "Atomoxetine", "Citalopram", "Methylphenidate"))
##Barplot
miss2.graph <- summarySE(aggdata_MISS, measurevar = "Miss", groupvars = c("Treatment"), na.rm = TRUE)
miss2.graph$Miss_mean<-miss2.graph$Miss
miss2.graph$Treatment<-ordered(miss2.graph$Treatment,c("PLA","MPH","ATM","CIT"))
ggplot(data=aggdata.miss2, aes(x=Treatment, y=Miss, fill = Treatment)) +
geom_bar(stat="identity")
##Graph of the interaction between treatment and block number on missed targets
aggdata.miss<-aggregate(CTET_Behaviour$Miss, list(BlockN=CTET_Behaviour$BlockN,Treatment=CTET_Behaviour$Treatment), mean,na.rm=TRUE)
colnames(aggdata.miss) = c("BlockN", "Treatment","Miss")
miss.graph <- summarySE(aggdata_MISS, measurevar = "Miss", groupvars = c("BlockN", "Treatment"), na.rm = TRUE)
miss.graph$Miss_mean<-miss.graph$Miss
miss.graph$Treatment<-ordered(miss.graph$Treatment,c("PLA","MPH","ATM","CIT"))
#check if it's okay that you removed NAs
##Reference graph
ggplot(aggdata.miss, aes(x = BlockN, y = Miss, colour = Treatment)) + geom_point() + geom_line() + scale_colour_brewer(palette = "Dark2") + scale_fill_brewer(palette = "Dark2") + ggtitle("Missed targets according to block number and treatment") + ylab("Missed Target") + xlab("Block Number") + xlim(0, 12) + ylim(0, 0.5)
##Graph with Standard Error
ggplot(miss.graph, aes(x = BlockN, y = Miss_mean, colour = Treatment)) + geom_point() + geom_line() + scale_colour_brewer(palette = "Dark2") + scale_fill_brewer(palette = "Dark2") + ggtitle("Missed targets according to block number and treatment") + ylab("Mean Missed Targets") + xlab("Block Number") + xlim(0, 11) + ylim(0.1, 0.5) + geom_errorbar(aes(ymin = Miss_mean-se, ymax = Miss_mean+se), size = .4, width = .5, alpha = .3) + scale_colour_discrete(name = "Treatment", breaks = c("PLA", "ATM", "CIT", "MPH"), labels = c("Placebo", "Atomoxetine", "Citalopram", "Methylphenidate"))
##Barplot
miss2.graph <- summarySE(aggdata_MISS, measurevar = "Miss", groupvars = c("Treatment"), na.rm = TRUE)
miss2.graph$Miss_mean<-miss2.graph$Miss
miss2.graph$Treatment<-ordered(miss2.graph$Treatment,c("PLA","MPH","ATM","CIT"))
ggplot(data=aggdata.miss, aes(x=Treatment, y=Miss, fill = Treatment)) +
geom_bar(stat="identity")
ggplot(data= miss2.graph, aes(x=Treatment, y=Miss_mean, fill = Treatment)) +
geom_bar(stat="identity") + geom_errorbar(aes(ymin = Miss_mean-se, ymax = Miss_mean+se), width = .2, size = .3) + scale_fill_discrete( name = "Treatment", breaks = c("PLA", "ATM", "CIT", "MPH"), labels = c("Placebo", "Atomoxetine", "Citalopram", "Methylphenidate")) + ylab("Mean Missed Targets")
##Graph of the interaction between treatment and block number on missed targets
aggdata.miss<-aggregate(CTET_Behaviour$Miss, list(BlockN=CTET_Behaviour$BlockN,Treatment=CTET_Behaviour$Treatment), mean,na.rm=TRUE)
colnames(aggdata.miss) = c("BlockN", "Treatment","Miss")
miss.graph <- summarySE(aggdata_MISS, measurevar = "Miss", groupvars = c("BlockN", "Treatment"), na.rm = TRUE)
miss.graph$Miss_mean<-miss.graph$Miss
miss.graph$Treatment<-ordered(miss.graph$Treatment,c("PLA","MPH","ATM","CIT"))
#check if it's okay that you removed NAs
##Reference graph
ggplot(aggdata.miss, aes(x = BlockN, y = Miss, colour = Treatment)) + geom_point() + geom_line() + scale_colour_brewer(palette = "Dark2") + scale_fill_brewer(palette = "Dark2") + ggtitle("Missed targets according to block number and treatment") + ylab("Missed Target") + xlab("Block Number") + xlim(0, 12) + ylim(0, 0.5)
##Graph with Standard Error
ggplot(miss.graph, aes(x = BlockN, y = Miss_mean, colour = Treatment)) + geom_point() + geom_line() + scale_colour_brewer(palette = "Dark2") + scale_fill_brewer(palette = "Dark2") + ggtitle("Missed targets according to block number and treatment") + ylab("Mean Missed Targets") + xlab("Block Number") + xlim(0, 11) + ylim(0.1, 0.5) + geom_errorbar(aes(ymin = Miss_mean-se, ymax = Miss_mean+se), size = .4, width = .5, alpha = .3) + scale_colour_discrete(name = "Treatment", breaks = c("PLA","MPH","ATM","CIT"), labels = c("Placebo", "Methylphenidate", "Atomoxetine", "Citalopram"))
##Barplot
miss2.graph <- summarySE(aggdata_MISS, measurevar = "Miss", groupvars = c("Treatment"), na.rm = TRUE)
miss2.graph$Miss_mean<-miss2.graph$Miss
miss2.graph$Treatment<-ordered(miss2.graph$Treatment,c("PLA","MPH","ATM","CIT"))
ggplot(data=aggdata.miss, aes(x=Treatment, y=Miss, fill = Treatment)) +
geom_bar(stat="identity")
ggplot(data= miss2.graph, aes(x=Treatment, y=Miss_mean, fill = Treatment)) +
geom_bar(stat="identity") + geom_errorbar(aes(ymin = Miss_mean-se, ymax = Miss_mean+se), width = .2, size = .3) + scale_fill_discrete( name = "Treatment", breaks = c("PLA","MPH","ATM","CIT"), labels = c("Placebo", "Methylphenidate", "Atomoxetine", "Citalopram")) + ylab("Mean Missed Targets")
##Graph of the interaction between treatment and block number on missed targets
aggdata.miss<-aggregate(CTET_Behaviour$Miss, list(BlockN=CTET_Behaviour$BlockN,Treatment=CTET_Behaviour$Treatment), mean,na.rm=TRUE)
colnames(aggdata.miss) = c("BlockN", "Treatment","Miss")
miss.graph <- summarySE(aggdata_MISS, measurevar = "Miss", groupvars = c("BlockN", "Treatment"), na.rm = TRUE)
miss.graph$Miss_mean<-miss.graph$Miss
miss.graph$Treatment<-ordered(miss.graph$Treatment,c("PLA","MPH","ATM","CIT"))
#check if it's okay that you removed NAs
##Reference graph
ggplot(aggdata.miss, aes(x = BlockN, y = Miss, colour = Treatment)) + geom_point() + geom_line() + scale_colour_brewer(palette = "Dark2") + scale_fill_brewer(palette = "Dark2") + ggtitle("Missed targets according to block number and treatment") + ylab("Missed Target") + xlab("Block Number") + xlim(0, 12) + ylim(0, 0.5)
##Graph with Standard Error
ggplot(miss.graph, aes(x = BlockN, y = Miss_mean, colour = Treatment)) + geom_point() + geom_line() + scale_colour_brewer(palette = "Dark2") + scale_fill_brewer(palette = "Dark2") + ggtitle("Missed targets according to block number and treatment") + ylab("Mean Missed Targets") + xlab("Block Number") + xlim(0, 11) + ylim(0.1, 0.5) + geom_errorbar(aes(ymin = Miss_mean-se, ymax = Miss_mean+se), size = .4, width = .5, alpha = 1) + scale_colour_discrete(name = "Treatment", breaks = c("PLA","MPH","ATM","CIT"), labels = c("Placebo", "Methylphenidate", "Atomoxetine", "Citalopram"))
##Barplot
miss2.graph <- summarySE(aggdata_MISS, measurevar = "Miss", groupvars = c("Treatment"), na.rm = TRUE)
miss2.graph$Miss_mean<-miss2.graph$Miss
miss2.graph$Treatment<-ordered(miss2.graph$Treatment,c("PLA","MPH","ATM","CIT"))
ggplot(data=aggdata.miss, aes(x=Treatment, y=Miss, fill = Treatment)) +
geom_bar(stat="identity")
ggplot(data= miss2.graph, aes(x=Treatment, y=Miss_mean, fill = Treatment)) +
geom_bar(stat="identity") + geom_errorbar(aes(ymin = Miss_mean-se, ymax = Miss_mean+se), width = .2, size = .3) + scale_fill_discrete( name = "Treatment", breaks = c("PLA","MPH","ATM","CIT"), labels = c("Placebo", "Methylphenidate", "Atomoxetine", "Citalopram")) + ylab("Mean Missed Targets")
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(ggpubr)
library(car)
library(haven)
library(data.table)
library(visreg)
library(dplyr)
library(tidyr)
library(reshape2)
library(rstatix)
library(JWileymisc)
library(lme4)
library(lmerTest)
library(multilevelTools)
library(ggstance)
library(jtools)
library(broom.mixed)
library(sjPlot)
library(glmmTMB)
library(lattice)
library(arm)
library(plyr)
library(Rmisc)
library(plotly)
##NOT WORKING:  CTET_Behaviour1 <- read.table("../Tables/CTET_behav_resblock.txt", header = TRUE, sep = ",", stringsAsFactors = FALSE)
CTET_Behaviour1 <- read.csv("~/Desktop/PSY4100/LS_NeuroM/Tables/CTET_behav_resblock.txt")
setwd("~/WorkGit/projects/inprogress/LS_NeuroM/R_functions")
CTET_Behaviour1 <- read.csv("../Tables/CTET_behav_resblock.txt")
CTET_Behaviour1$SubID<-as.factor(CTET_Behaviour1$SubID)
CTET_Behaviour1$Treatment<-as.factor(CTET_Behaviour1$Treatment)
CTET_Behaviour1<-CTET_Behaviour1[as.numeric(CTET_Behaviour1$BlockN)<11,]
CTET_Behaviour1$BlockN<-as.numeric(CTET_Behaviour1$BlockN)
CTET_Behaviour1$Treatment<-relevel(CTET_Behaviour1$Treatment,"PLA")
CTET_Behaviour1<-CTET_Behaviour1[!is.na(CTET_Behaviour1$BlockN),]
##False Alarm
lm.FA0 <- lmer(FA ~ 1 + (1|SubID), data = CTET_Behaviour1, REML = FALSE)
##Effects of treatment on false alarms
lm.FA1 <- lmer(FA ~ 1 + Treatment + (1|SubID), data = CTET_Behaviour1, REML = FALSE)
#Added effects of block number on false alarm
lm.FA2 <- lmer(FA ~ 1 + Treatment + BlockN + (1|SubID), data = CTET_Behaviour1, REML = FALSE)
#Added effects of block number as an interaction on false alarm
lm.FA3 <- lmer(FA ~ 1 + Treatment * BlockN + (1|SubID), data = CTET_Behaviour1, REML = FALSE)
##Anova to see which one has the most interaction
anova(lm.FA0,lm.FA1,lm.FA2,lm.FA3)
lm.FA2 <- lmer(FA ~ 1 + Treatment + BlockN + (1|SubID), data = CTET_Behaviour1, REML = TRUE)
summary(lm.FA2)
confint(lm.FA2, method = "Wald", oldNames = FALSE)
## Normality plot of residuals - TA: Try to plot QQ plots
hist(residuals(lm.FA2))
qqnorm(resid(lm.FA2))
qqline(resid(lm.FA2))
plot(lm.FA2)
plot(fitted(lm.FA2), resid(lm.FA2))
binnedplot(fitted(lm.FA2),resid(lm.FA2))
##Misses
lm.Miss0 <- lmer(Miss ~ 1 + (1|SubID), data = CTET_Behaviour1, REML = FALSE)
##Effects of treatment on misses
lm.Miss1 <- lmer(Miss ~ 1 + Treatment + (1|SubID), data =  CTET_Behaviour1, REML = FALSE)
##Added effects of block number on misses
lm.Miss2 <- lmer(Miss ~ 1 + Treatment + BlockN + (1|SubID), data =  CTET_Behaviour1, REML = FALSE)
##Added effects of block number as an interaction on misses
lm.Miss3 <- lmer(Miss ~ 1 + Treatment*BlockN + (1|SubID), data =  CTET_Behaviour1, REML = FALSE)
##Anova to see which one has the most interaction
anova(lm.Miss0,lm.Miss1,lm.Miss2,lm.Miss3)
lm.Miss3 <- lmer(Miss ~ 1 + Treatment*BlockN + (1|SubID), data =  CTET_Behaviour1, REML = TRUE)
summary(lm.Miss3)
confint(lm.Miss3, method = "Wald", oldNames = FALSE)
##Normality plot of residuals
hist(residuals(lm.Miss3))
boxplot(residuals(lm.Miss3))
qqnorm(resid(lm.Miss3))
qqline(resid(lm.Miss3))
plot(lm.Miss3)
plot(fitted(lm.Miss3), resid(lm.Miss3))
binnedplot(fitted(lm.Miss3),resid(lm.Miss3))
##Hit Rate
lm.HR0 <- lmer(Hit_RT ~ 1 + (1|SubID), data = CTET_Behaviour1, REML = FALSE)
##Effects of treatment on hit rate
lm.HR1 <- lmer(Hit_RT ~ 1 + Treatment + (1|SubID), data = CTET_Behaviour1, REML = FALSE)
##Added effects of block number on hit rate
lm.HR2 <- lmer(Hit_RT ~ 1 + Treatment + BlockN + (1|SubID), data = CTET_Behaviour1, REML = FALSE)
##Added effects of block number as an interaction on hit rate
lm.HR3 <- lmer(Hit_RT ~ 1 + Treatment*BlockN + (1|SubID), data = CTET_Behaviour1, REML = FALSE)
##Anova to see which one has the most interaction
anova(lm.HR0,lm.HR1,lm.HR2,lm.HR3)
lm.HR1 <- lmer(Hit_RT ~ 1 + Treatment + (1|SubID), data = CTET_Behaviour1, REML = TRUE)
summary(lm.HR1)
confint(lm.HR1, method = "Wald", oldNames = FALSE)
## Normality plot of residuals
hist(residuals(lm.HR1))
boxplot(residuals(lm.HR1))
qqnorm(residuals(lm.HR1))
qqline(resid(lm.HR1))
plot(lm.HR3)
plot(fitted(lm.HR1), resid(lm.HR1))
binnedplot(fitted(lm.HR1), resid(lm.HR1))
##Graph of the interaction between treatment and block number on false alarms
fa.graph <- summarySE(CTET_Behaviour1, measurevar = "FA", groupvars = c("BlockN", "Treatment"))
fa.graph$Treatment<-ordered(fa.graph$Treatment, c("PLA","MPH","ATM","CIT"))
##REFERENCE GRAPH
ggplot(fa.graph, aes(x = BlockN, y = FA, colour = Treatment)) + geom_point() + geom_line() + scale_colour_brewer(palette = "Dark2") + scale_fill_brewer(palette = "Dark2") + ggtitle("False alarms according to block number and treatment") + ylab("False Alarms") + xlab("Block Number") + xlim(0, 10.5) + ylim(0, 0.01)
##Graph with Standard Error
ggplot(fa.graph, aes(x = BlockN, y = FA, colour = Treatment)) + geom_point() + geom_line() +  ggtitle("False alarms according to block number and treatment") + ylab("Mean False Alarms") + xlab("Block Number") + xlim(0, 10.5) + ylim(0, 0.01) + geom_ribbon(aes(ymin = FA-se, ymax = FA+se, fill = Treatment), alpha = .35, linetype = 0) + scale_fill_manual(values = c("#666666", "#990000", "#CC0000", "#000099")) + scale_colour_manual(values = c("#666666", "#990000", "#FF0000", "#000099"))
##Barplot
fa2.graph <- summarySE(CTET_Behaviour1, measurevar = "FA", groupvars = c( "Treatment"))
fa2.graph$FA<-fa2.graph$FA
fa2.graph$Treatment<-ordered(fa2.graph$Treatment,c("PLA","MPH","ATM","CIT"))
ggplot(data=fa2.graph, aes(x=Treatment, y=FA, fill = Treatment)) +
geom_bar(stat="identity") + geom_errorbar(aes(ymin = FA-se, ymax = FA+se), width = .4, size = .45) + scale_fill_discrete( name = "Treatment", breaks = c("PLA", "MPH", "ATM", "CIT"), labels = c("Placebo", "Methylphenidate", "Atomoxetine", "Citalopram")) + ylab("Mean False Alarm")+ scale_fill_manual(values = c("#666666", "#990000", "#CC0000", "#000099"))
View(fa2.graph)
View(fa.graph)
##Graph of the interaction between treatment and block number on false alarms
fa.graph <- summarySE(CTET_Behaviour1, measurevar = "FA", groupvars = c("BlockN", "Treatment"))
fa.graph$Treatment<-ordered(fa.graph$Treatment, c("PLA","MPH","ATM","CIT"))
##REFERENCE GRAPH
ggplot(fa.graph, aes(x = BlockN, y = FA, colour = Treatment)) + geom_point() + geom_line() + scale_colour_brewer(palette = "Dark2") + scale_fill_brewer(palette = "Dark2") + ggtitle("False alarms according to block number and treatment") + ylab("False Alarms") + xlab("Block Number") + xlim(0, 10.5) + ylim(0, 0.01)
##Graph with Standard Error
ggplot(fa.graph, aes(x = BlockN, y = FA, colour = Treatment)) + geom_point() + geom_line() +  ggtitle("False alarms according to block number and treatment") + ylab("Mean False Alarms") + xlab("Block Number") + xlim(0, 10.5) + ylim(0, 0.01) + geom_ribbon(aes(ymin = FA-se, ymax = FA+se, fill = Treatment), alpha = .35, linetype = 0) + scale_fill_manual(values = c("#666666", "#a6cee3", "#1f78b4", "#b2df8a")) + scale_colour_manual(values = c("#666666", "#a6cee3", "#1f78b4", "#b2df8a"))
##Barplot
fa2.graph <- summarySE(CTET_Behaviour1, measurevar = "FA", groupvars = c( "Treatment"))
fa2.graph$FA<-fa2.graph$FA
fa2.graph$Treatment<-ordered(fa2.graph$Treatment,c("PLA","MPH","ATM","CIT"))
ggplot(data=fa2.graph, aes(x=Treatment, y=FA, fill = Treatment)) +
geom_bar(stat="identity") + geom_errorbar(aes(ymin = FA-se, ymax = FA+se), width = .4, size = .45) + scale_fill_discrete( name = "Treatment", breaks = c("PLA", "MPH", "ATM", "CIT"), labels = c("Placebo", "Methylphenidate", "Atomoxetine", "Citalopram")) + ylab("Mean False Alarm")+ scale_fill_manual(values = c("#666666", "#a6cee3", "#1f78b4", "#b2df8a"))
##Graph of the interaction between treatment and block number on false alarms
fa.graph <- summarySE(CTET_Behaviour1, measurevar = "FA", groupvars = c("BlockN", "Treatment"))
fa.graph$Treatment<-ordered(fa.graph$Treatment, c("PLA","MPH","ATM","CIT"))
##REFERENCE GRAPH
ggplot(fa.graph, aes(x = BlockN, y = FA, colour = Treatment)) + geom_point() + geom_line() + scale_colour_brewer(palette = "Dark2") + scale_fill_brewer(palette = "Dark2") + ggtitle("False alarms according to block number and treatment") + ylab("False Alarms") + xlab("Block Number") + xlim(0, 10.5) + ylim(0, 0.01)
##Graph with Standard Error
ggplot(fa.graph, aes(x = BlockN, y = FA, colour = Treatment)) + geom_point() + geom_line() +  ggtitle("False alarms according to block number and treatment") + ylab("Mean False Alarms") + xlab("Block Number") + xlim(0, 10.5) + ylim(0, 0.01) + geom_ribbon(aes(ymin = FA-se, ymax = FA+se, fill = Treatment), alpha = .35, linetype = 0) + scale_fill_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77")) + scale_colour_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77"))
##Barplot
fa2.graph <- summarySE(CTET_Behaviour1, measurevar = "FA", groupvars = c( "Treatment"))
fa2.graph$FA<-fa2.graph$FA
fa2.graph$Treatment<-ordered(fa2.graph$Treatment,c("PLA","MPH","ATM","CIT"))
ggplot(data=fa2.graph, aes(x=Treatment, y=FA, fill = Treatment)) +
geom_bar(stat="identity") + geom_errorbar(aes(ymin = FA-se, ymax = FA+se), width = .4, size = .45) + scale_fill_discrete( name = "Treatment", breaks = c("PLA", "MPH", "ATM", "CIT"), labels = c("Placebo", "Methylphenidate", "Atomoxetine", "Citalopram")) + ylab("Mean False Alarm")+ scale_fill_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77"))
fa2.graph$FA[fa2.graph$Treatment=="ATM"]
fa2.graph$FA[fa2.graph$Treatment=="ATM",]
fa2.graph$FA[,fa2.graph$Treatment=="ATM"]
fa2.graph$FA[fa2.graph$Treatment=="ATM"]
fa.graph$FA[fa.graph$Treatment=="ATM"]
fa.graph$se[fa.graph$Treatment=="ATM"]
fa.graph$FA[fa.graph$Treatment=="ATM"]+fa.graph$se[fa.graph$Treatment=="ATM"]
##Graph of the interaction between treatment and block number on false alarms
fa.graph <- summarySE(CTET_Behaviour1, measurevar = "FA", groupvars = c("BlockN", "Treatment"))
fa.graph$Treatment<-ordered(fa.graph$Treatment, c("PLA","MPH","ATM","CIT"))
##REFERENCE GRAPH
fa.graph<-fa.graph[,fa.graph$Treatment=="ATM"]
fa.graph<-fa.graph[fa.graph$Treatment=="ATM"]
fa.graph <- summarySE(CTET_Behaviour1, measurevar = "FA", groupvars = c("BlockN", "Treatment"))
fa.graph$Treatment<-ordered(fa.graph$Treatment, c("PLA","MPH","ATM","CIT"))
##REFERENCE GRAPH
fa.graph<-fa.graph[fa.graph$Treatment=="ATM",]
View(fa.graph)
ggplot(fa.graph, aes(x = BlockN, y = FA, colour = Treatment)) + geom_point() + geom_line() + scale_colour_brewer(palette = "Dark2") + scale_fill_brewer(palette = "Dark2") + ggtitle("False alarms according to block number and treatment") + ylab("False Alarms") + xlab("Block Number") + xlim(0, 10.5) + ylim(0, 0.01)
ggplot(fa.graph, aes(x = BlockN, y = FA, colour = Treatment)) + geom_point() + geom_line() +  ggtitle("False alarms according to block number and treatment") + ylab("Mean False Alarms") + xlab("Block Number") + xlim(0, 10.5) + ylim(0, 0.01) + geom_ribbon(aes(ymin = FA-se, ymax = FA+se, fill = Treatment), alpha = .35, linetype = 0) + scale_fill_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77")) + scale_colour_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77"))
##Graph with Standard Error
ggplot(fa.graph, aes(x = BlockN, y = FA, colour = Treatment)) + geom_point() + geom_line() +  ggtitle("False alarms according to block number and treatment") + ylab("Mean False Alarms") + xlab("Block Number") + xlim(0, 10.5) + ylim(0, 0.02) + geom_ribbon(aes(ymin = FA-se, ymax = FA+se, fill = Treatment), alpha = .35, linetype = 0) + scale_fill_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77")) + scale_colour_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77"))
##Graph of the interaction between treatment and block number on false alarms
fa.graph <- summarySE(CTET_Behaviour1, measurevar = "FA", groupvars = c("BlockN", "Treatment"))
fa.graph$Treatment<-ordered(fa.graph$Treatment, c("PLA","MPH","ATM","CIT"))
##REFERENCE GRAPH
ggplot(fa.graph, aes(x = BlockN, y = FA, colour = Treatment)) + geom_point() + geom_line() + scale_colour_brewer(palette = "Dark2") + scale_fill_brewer(palette = "Dark2") + ggtitle("False alarms according to block number and treatment") + ylab("False Alarms") + xlab("Block Number") + xlim(0, 10.5) + ylim(0, 0.01)
##Graph with Standard Error
ggplot(fa.graph, aes(x = BlockN, y = FA, colour = Treatment)) + geom_point() + geom_line() +  ggtitle("False alarms according to block number and treatment") + ylab("Mean False Alarms") + xlab("Block Number") + xlim(0, 10.5) + ylim(0, 0.013) + geom_ribbon(aes(ymin = FA-se, ymax = FA+se, fill = Treatment), alpha = .35, linetype = 0) + scale_fill_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77")) + scale_colour_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77"))
##Barplot
fa2.graph <- summarySE(CTET_Behaviour1, measurevar = "FA", groupvars = c( "Treatment"))
fa2.graph$FA<-fa2.graph$FA
fa2.graph$Treatment<-ordered(fa2.graph$Treatment,c("PLA","MPH","ATM","CIT"))
ggplot(data=fa2.graph, aes(x=Treatment, y=FA, fill = Treatment)) +
geom_bar(stat="identity") + geom_errorbar(aes(ymin = FA-se, ymax = FA+se), width = .4, size = .45) + scale_fill_discrete( name = "Treatment", breaks = c("PLA", "MPH", "ATM", "CIT"), labels = c("Placebo", "Methylphenidate", "Atomoxetine", "Citalopram")) + ylab("Mean False Alarm")+ scale_fill_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77"))
##Graph of the interaction between treatment and block number on false alarms
fa.graph <- summarySE(CTET_Behaviour1, measurevar = "FA", groupvars = c("BlockN", "Treatment"))
fa.graph$Treatment<-ordered(fa.graph$Treatment, c("PLA","MPH","ATM","CIT"))
##REFERENCE GRAPH
ggplot(fa.graph, aes(x = BlockN, y = FA, colour = Treatment)) + geom_point() + geom_line() + scale_colour_brewer(palette = "Dark2") + scale_fill_brewer(palette = "Dark2") + ggtitle("False alarms according to block number and treatment") + ylab("False Alarms") + xlab("Block Number") + xlim(0, 10.5) + ylim(0, 0.01)
##Graph with Standard Error
ggplot(fa.graph, aes(x = BlockN, y = FA, colour = Treatment)) + geom_point() + geom_line() +  ggtitle("False alarms according to block number and treatment") + ylab("Mean False Alarms") + xlab("Block Number") + xlim(0, 10.5) + ylim(0, 0.011) + geom_ribbon(aes(ymin = FA-se, ymax = FA+se, fill = Treatment), alpha = .35, linetype = 0) + scale_fill_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77")) + scale_colour_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77"))
##Barplot
fa2.graph <- summarySE(CTET_Behaviour1, measurevar = "FA", groupvars = c( "Treatment"))
fa2.graph$FA<-fa2.graph$FA
fa2.graph$Treatment<-ordered(fa2.graph$Treatment,c("PLA","MPH","ATM","CIT"))
ggplot(data=fa2.graph, aes(x=Treatment, y=FA, fill = Treatment)) +
geom_bar(stat="identity") + geom_errorbar(aes(ymin = FA-se, ymax = FA+se), width = .4, size = .45) + scale_fill_discrete( name = "Treatment", breaks = c("PLA", "MPH", "ATM", "CIT"), labels = c("Placebo", "Methylphenidate", "Atomoxetine", "Citalopram")) + ylab("Mean False Alarm")+ scale_fill_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77"))
##Graph of the interaction between treatment and block number on missed targets
miss.graph <- summarySE(CTET_Behaviour1, measurevar = "Miss", groupvars = c("BlockN", "Treatment"), na.rm = TRUE)
miss.graph$Treatment<-ordered(miss.graph$Treatment,c("PLA","MPH","ATM","CIT"))
##Reference graph
ggplot(miss.graph, aes(x = BlockN, y = Miss, colour = Treatment)) + geom_point() + geom_line() + scale_colour_brewer(palette = "Dark2") + scale_fill_brewer(palette = "Dark2") + ggtitle("Missed targets according to block number and treatment") + ylab("Missed Target") + xlab("Block Number") + xlim(0, 12) + ylim(0, 0.5)
##Graph with Standard Error
ggplot(miss.graph, aes(x = BlockN, y = Miss, colour = Treatment)) + geom_point() + geom_line() + ggtitle("Missed targets according to block number and treatment") + ylab("Mean Missed Targets") + xlab("Block Number") + xlim(0, 11) + ylim(0.1, 0.5) + geom_ribbon(aes(ymin = Miss-se, ymax = Miss+se, fill = Treatment), alpha = .35, linetype = 0) + scale_fill_manual(values = c("#666666", "#990000", "#CC0000", "#000099")) + scale_colour_manual(values = c("#666666", "#990000", "#FF0000", "#000099"))
##Barplot
miss2.graph <- summarySE(CTET_Behaviour1, measurevar = "Miss", groupvars = c("Treatment"), na.rm = TRUE)
miss2.graph$Treatment<-ordered(miss2.graph$Treatment,c("PLA","MPH","ATM","CIT"))
ggplot(data= miss2.graph, aes(x=Treatment, y=Miss, fill = Treatment)) +
geom_bar(stat="identity") + geom_errorbar(aes(ymin = Miss-se, ymax = Miss+se), width = .35, size = .6)  + scale_fill_manual(values = c("#666666", "#990000", "#CC0000", "#000099")) + labs (title = "Bar Plot of The Mean Misses Per Treatment", y = "Mean Misses")
##Graph of the interaction between treatment and block number on hit rates
rt.graph <- summarySE(CTET_Behaviour1, measurevar = "Hit_RT", groupvars = c("BlockN", "Treatment"), na.rm = TRUE)
rt.graph$Treatment<-ordered(rt.graph$Treatment,c("PLA","MPH","ATM","CIT"))
##Reference graph
ggplot(rt.graph, aes(x = BlockN, y = Hit_RT, colour = Treatment)) + geom_point() + geom_line() + scale_colour_brewer(palette = "Dark2") + scale_fill_brewer(palette = "Dark2") + ggtitle("False alarms according to block number and treatment") + ylab("Hit Rate") + xlab("Block Number") + xlim(0, 11) + ylim(1.3, 1.5)
##Graph with Standard Error
ggplot(rt.graph, aes(x = BlockN, y = Hit_RT, colour = Treatment)) + geom_point() + geom_line(alpha = .7) +  ggtitle("Hit rate according to block number and treatment") + ylab("Mean Hit Rate") + xlab("Block Number") + xlim(0, 11) + ylim(1.3, 1.5) + geom_ribbon(aes(ymin = Hit_RT-se, ymax = Hit_RT+se, fill = Treatment), alpha = .35, linetype = 0) + scale_fill_manual(values = c("#666666", "#990000", "#CC0000", "#000099")) + scale_colour_manual(values = c("#666666", "#990000", "#FF0000", "#000099"))
##Bar plot
rt2.graph <- summarySE(CTET_Behaviour1, measurevar = "Hit_RT", groupvars = c("Treatment"), na.rm = TRUE)
rt2.graph$Treatment<-ordered(rt2.graph$Treatment,c("PLA","MPH","ATM","CIT"))
ggplot(data= rt2.graph, aes(x=Treatment, y=Hit_RT, fill = Treatment)) +
geom_bar(stat="identity") + geom_errorbar(aes(ymin = Hit_RT-se, ymax = Hit_RT+se), width = .4, size = .5) + scale_fill_manual(values = c("#666666", "#990000", "#CC0000", "#000099")) + ylim(0, 2) + labs(title = "Bar Plot of The Mean Hit Rates Per Treatment", y = "Mean Hit Rates") + coord_cartesian(ylim =c(1.35, 1.45))
##Graph of the interaction between treatment and block number on hit rates
rt.graph <- summarySE(CTET_Behaviour1, measurevar = "Hit_RT", groupvars = c("BlockN", "Treatment"), na.rm = TRUE)
rt.graph$Treatment<-ordered(rt.graph$Treatment,c("PLA","MPH","ATM","CIT"))
##Reference graph
ggplot(rt.graph, aes(x = BlockN, y = Hit_RT, colour = Treatment)) + geom_point() + geom_line() + scale_colour_brewer(palette = "Dark2") + scale_fill_brewer(palette = "Dark2") + ggtitle("Mean RT for Hits according to block number and treatment") + ylab("Hit Rate") + xlab("Block Number") + xlim(0, 11) + ylim(1.3, 1.5)
##Graph with Standard Error
ggplot(rt.graph, aes(x = BlockN, y = Hit_RT, colour = Treatment)) + geom_point() + geom_line(alpha = .7) +  ggtitle("Mean RT for Hits according to block number and treatment") + ylab("Mean RT Hit") + xlab("Block Number") + xlim(0, 11) + ylim(1.3, 1.5) + geom_ribbon(aes(ymin = Hit_RT-se, ymax = Hit_RT+se, fill = Treatment), alpha = .35, linetype = 0) + scale_fill_manual(values = c("#666666", "#990000", "#CC0000", "#000099")) + scale_colour_manual(values = c("#666666", "#990000", "#FF0000", "#000099"))
##Bar plot
rt2.graph <- summarySE(CTET_Behaviour1, measurevar = "Hit_RT", groupvars = c("Treatment"), na.rm = TRUE)
rt2.graph$Treatment<-ordered(rt2.graph$Treatment,c("PLA","MPH","ATM","CIT"))
ggplot(data= rt2.graph, aes(x=Treatment, y=Hit_RT, fill = Treatment)) +
geom_bar(stat="identity") + geom_errorbar(aes(ymin = Hit_RT-se, ymax = Hit_RT+se), width = .4, size = .5) + scale_fill_manual(values = c("#666666", "#990000", "#CC0000", "#000099")) + ylim(0, 2) + labs(title = "Bar Plot of The Mean RT for Hits Per Treatment", y = "Mean RT Hit") + coord_cartesian(ylim =c(1.35, 1.45))
