ggplot(fa.aggA, aes (x = SWdens, y = FA, colour = Treatment)) + geom_point(alpha = .65, size = 2.4)+ geom_smooth(method=lm, se = FALSE)+ scale_colour_manual(values = c("#666666", "#7570b3"))
ggplot(fa.aggC, aes (x = SWdens, y = FA, colour = Treatment)) + geom_point(alpha = .65, size = 2.4)+ geom_smooth(method=lm, se = FALSE)+ scale_colour_manual(values = c("#666666", "#1b9e77"))
miss.aggM <- aggregate(. ~ SubID+Treatment, data = miss.mph, FUN = mean)
miss.aggA <- aggregate(. ~ SubID+Treatment, data = miss.atm, FUN = mean)
miss.aggC <- aggregate(. ~ SubID+Treatment, data = miss.cit, FUN = mean)
##Scatterplot of slow wave density and misses
ggplot(miss.aggM, aes (x = SWdens, y = FA, colour = Treatment)) + geom_point(alpha = .6, size = 2.4)+ geom_smooth(method=lm, se = FALSE)+ scale_colour_manual(values = c("#666666", "#d95f02"))
ggplot(miss.aggA, aes (x = SWdens, y = FA, colour = Treatment)) + geom_point(alpha = .65, size = 2.4)+ geom_smooth(method=lm, se = FALSE)+ scale_colour_manual(values = c("#666666", "#7570b3"))
ggplot(miss.aggC, aes (x = SWdens, y = FA, colour = Treatment)) + geom_point(alpha = .65, size = 2.4)+ geom_smooth(method=lm, se = FALSE)+ scale_colour_manual(values = c("#666666", "#1b9e77"))
hr.aggM <- aggregate(. ~ SubID+Treatment, data = hr.mph, FUN = mean)
hr.aggA <- aggregate(. ~ SubID+Treatment, data = hr.atm, FUN = mean)
hr.aggC <- aggregate(. ~ SubID+Treatment, data = hr.cit, FUN = mean)
ggplot(hr.aggM, aes (x = SWdens, y = FA, colour = Treatment)) + geom_point(alpha = .6, size = 2.4)+ geom_smooth(method=lm, se = FALSE)+ scale_colour_manual(values = c("#666666", "#d95f02"))
ggplot(hr.aggA, aes (x = SWdens, y = FA, colour = Treatment)) + geom_point(alpha = .65, size = 2.4)+ geom_smooth(method=lm, se = FALSE)+ scale_colour_manual(values = c("#666666", "#7570b3"))
ggplot(hr.aggC, aes (x = SWdens, y = FA, colour = Treatment)) + geom_point(alpha = .65, size = 2.4)+ geom_smooth(method=lm, se = FALSE)+ scale_colour_manual(values = c("#666666", "#1b9e77"))
##Scatterplot of slow wave density and reaction time per treatment
ggplot(hr.aggM, aes (x = SWdens, y = FA, colour = Treatment)) + geom_point(alpha = .6, size = 2.7)+ geom_smooth(method=lm, se = FALSE)+ scale_colour_manual(values = c("#666666", "#d95f02"))
ggplot(hr.aggA, aes (x = SWdens, y = FA, colour = Treatment)) + geom_point(alpha = .65, size = 2.7)+ geom_smooth(method=lm, se = FALSE)+ scale_colour_manual(values = c("#666666", "#7570b3"))
ggplot(hr.aggC, aes (x = SWdens, y = FA, colour = Treatment)) + geom_point(alpha = .65, size = 2.7)+ geom_smooth(method=lm, se = FALSE)+ scale_colour_manual(values = c("#666666", "#1b9e77"))
ggplot(miss.aggC, aes (x = SWdens, y = FA, colour = Treatment)) + geom_point(alpha = .65, size = 2.7)+ geom_smooth(method=lm, se = FALSE)+ scale_colour_manual(values = c("#666666", "#1b9e77"))
ggplot(miss.aggC, aes (x = SWdens, y = FA, colour = Treatment)) + geom_point(alpha = .75, size = 2.7)+ geom_smooth(method=lm, se = FALSE)+ scale_colour_manual(values = c("#666666", "#1b9e77"))
ggplot(miss.aggC, aes (x = SWdens, y = FA, colour = Treatment)) + geom_point(alpha = .7, size = 2.7)+ geom_smooth(method=lm, se = FALSE)+ scale_colour_manual(values = c("#666666", "#1b9e77"))
ggplot(miss.aggC, aes (x = SWdens, y = FA, colour = Treatment)) + geom_point(alpha = .67, size = 2.7)+ geom_smooth(method=lm, se = FALSE)+ scale_colour_manual(values = c("#666666", "#1b9e77"))
ggplot(miss.aggC, aes (x = SWdens, y = FA, colour = Treatment)) + geom_point(alpha = .65, size = 2.7)+ geom_smooth(method=lm, se = FALSE)+ scale_colour_manual(values = c("#666666", "#1b9e77"))
ggplot(miss.aggC, aes (x = SWdens, y = FA, colour = Treatment)) + geom_point(alpha = .63, size = 2.7)+ geom_smooth(method=lm, se = FALSE)+ scale_colour_manual(values = c("#666666", "#1b9e77"))
ggplot(miss.aggC, aes (x = SWdens, y = FA, colour = Treatment)) + geom_point(alpha = .3, size = 2.7)+ geom_smooth(method=lm, se = FALSE)+ scale_colour_manual(values = c("#666666", "#1b9e77"))
ggplot(miss.aggC, aes (x = SWdens, y = FA, colour = Treatment)) + geom_point(alpha = .5, size = 2.7)+ geom_smooth(method=lm, se = FALSE)+ scale_colour_manual(values = c("#666666", "#1b9e77"))
ggplot(miss.aggC, aes (x = SWdens, y = FA, colour = Treatment)) + geom_point(alpha = .65, size = 2.7)+ geom_smooth(method=lm, se = FALSE)+ scale_colour_manual(values = c("#666666", "#1b9e77"))
ggplot(miss.aggA, aes (x = SWdens, y = FA, colour = Treatment)) + geom_point(alpha = .65, size = 2.7)+ geom_smooth(method=lm, se = FALSE)+ scale_colour_manual(values = c("#666666", "#7570b3"))
#GRAPH FOR EACH TREATMENT
##Scatterplot of slow wave density and false alarm per treatment
ggplot(fa.aggM, aes (x = SWdens, y = FA, colour = Treatment)) + geom_point(alpha = .6, size = 2.7)+ geom_smooth(method=lm, se = FALSE)+ scale_colour_manual(values = c("#666666", "#d95f02"))
ggplot(fa.aggA, aes (x = SWdens, y = FA, colour = Treatment)) + geom_point(alpha = .65, size = 2.7)+ geom_smooth(method=lm, se = FALSE)+ scale_colour_manual(values = c("#666666", "#7570b3"))
ggplot(fa.aggC, aes (x = SWdens, y = FA, colour = Treatment)) + geom_point(alpha = .65, size = 2.7)+ geom_smooth(method=lm, se = FALSE)+ scale_colour_manual(values = c("#666666", "#1b9e77"))
##Scatterplot of slow wave density and misses per treatmenr
ggplot(miss.aggM, aes (x = SWdens, y = FA, colour = Treatment)) + geom_point(alpha = .6, size = 2.7)+ geom_smooth(method=lm, se = FALSE)+ scale_colour_manual(values = c("#666666", "#d95f02"))
ggplot(miss.aggA, aes (x = SWdens, y = FA, colour = Treatment)) + geom_point(alpha = .65, size = 2.7)+ geom_smooth(method=lm, se = FALSE)+ scale_colour_manual(values = c("#666666", "#7570b3"))
ggplot(miss.aggC, aes (x = SWdens, y = FA, colour = Treatment)) + geom_point(alpha = .65, size = 2.7)+ geom_smooth(method=lm, se = FALSE)+ scale_colour_manual(values = c("#666666", "#1b9e77"))
##Scatterplot of slow wave density and reaction time per treatment
ggplot(hr.aggM, aes (x = SWdens, y = FA, colour = Treatment)) + geom_point(alpha = .6, size = 2.7)+ geom_smooth(method=lm, se = FALSE)+ scale_colour_manual(values = c("#666666", "#d95f02"))
ggplot(hr.aggA, aes (x = SWdens, y = FA, colour = Treatment)) + geom_point(alpha = .65, size = 2.7)+ geom_smooth(method=lm, se = FALSE)+ scale_colour_manual(values = c("#666666", "#7570b3"))
ggplot(hr.aggC, aes (x = SWdens, y = FA, colour = Treatment)) + geom_point(alpha = .65, size = 2.7)+ geom_smooth(method=lm, se = FALSE)+ scale_colour_manual(values = c("#666666", "#1b9e77"))
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(ggpubr)
library(car)
library(haven)
library(data.table)
library(visreg)
library(dplyr)
library(tidyr)
library(reshape2)
library(rstatix)
library(JWileymisc)
library(lme4)
library(lmerTest)
library(multilevelTools)
library(tidyverse)
library(mediation)
SWS_data <- read.table("../Tables/CTET_SWdetection_thr90_allE_P2P_behav_vec.txt", header = TRUE, sep = ",", stringsAsFactors = FALSE)
names(SWS_data)[names(SWS_data) == "Drug"] <- "Treatment"
SWS_data$Treatment<-as.factor(SWS_data$Treatment)
SWS_data$Treatment<-relevel(SWS_data$Treatment,"PLA")
SWS_data2<-aggregate(SWdens ~ SubID+Treatment+BlockN, data=SWS_data, FUN=mean)
#detach("package:multilevelTools", unload=TRUE)
#detach("package:lmerTest", unload=TRUE)
lm.FA0 <- lmer(FA ~ 1 + (1|SubID), data = SWS_data, REML = FALSE)
##Effects of treatment on false alarms
lm.FA1 <- lmer(FA ~ 1 + Treatment + (1|SubID), data = SWS_data, REML = FALSE)
#Added effects of block number on false alarm
lm.FA2 <- lmer(FA ~ 1 + Treatment + BlockN + (1|SubID), data = SWS_data, REML = FALSE)
#Added effects of block number as an interaction on false alarm
lm.FA3 <- lmer(FA ~ 1 + Treatment + BlockN + SWdens + (1|SubID), data = SWS_data, REML = FALSE)
##Anova to see which one has the most interaction
anova(lm.FA0,lm.FA1,lm.FA2,lm.FA3)
#detach("package:multilevelTools", unload=TRUE)
#detach("package:lmerTest", unload=TRUE)
lm.Miss0 <- lmer(Miss ~ 1 + (1|SubID), data = SWS_data, REML = FALSE)
##Effects of treatment on false alarms
lm.Miss1 <- lmer(Miss ~ 1 + Treatment + (1|SubID), data = SWS_data, REML = FALSE)
#Added effects of block number on false alarm
lm.Miss2 <- lmer(Miss ~ 1 + Treatment + BlockN + (1|SubID), data = SWS_data, REML = FALSE)
#Added effects of block number as an interaction on false alarm
lm.Miss3 <- lmer(Miss ~ 1 + Treatment + BlockN + SWdens + (1|SubID), data = SWS_data, REML = FALSE)
##Anova to see which one has the most interaction
anova(lm.Miss0,lm.Miss1,lm.Miss2,lm.Miss3)
#detach("package:multilevelTools", unload=TRUE)
#detach("package:lmerTest", unload=TRUE)
SWS_data3<-SWS_data[SWS_data$Treatment=="PLA" | SWS_data$Treatment=="CIT",]
SWS_data3$Treatment<-droplevels(SWS_data3$Treatment)
S
WS_data3$treat[SWS_data$Treatment]<-SWS_data3$Treatment=="CIT"
#detach("package:multilevelTools", unload=TRUE)
#detach("package:lmerTest", unload=TRUE)
SWS_data3<-SWS_data[SWS_data$Treatment=="PLA" | SWS_data$Treatment=="CIT",]
SWS_data3$Treatment<-droplevels(SWS_data3$Treatment)
SWS_data3$treat[SWS_data$Treatment]<-SWS_data3$Treatment=="CIT"
SWS_data3$treat<-as.integer(SWS_data3$treat)
med.fit <- lm(SWdens  ~ 1 + treat, data = SWS_data3)
out.fit <- lm(Miss  ~ 1 + SWdens + treat, data = SWS_data3)
med.out <- mediate(med.fit, out.fit, treat = "treat", mediator = "SWdens",robustSE = TRUE, sims = 100)
#detach("package:multilevelTools", unload=TRUE)
#detach("package:lmerTest", unload=TRUE)
SWS_data3<-SWS_data[SWS_data$Treatment=="PLA" | SWS_data$Treatment=="CIT",]
SWS_data3$Treatment<-droplevels(SWS_data3$Treatment)
SWS_data3$treat[SWS_data$Treatment]<-SWS_data3$Treatment=="CIT"
SWS_data3$treat<-as.integer(SWS_data3$treat)
med.fit <- lm(SWdens  ~ 1 + treat, data = SWS_data3)
out.fit <- lm(Miss  ~ 1 + SWdens + treat, data = SWS_data3)
med.out <- mediate(med.fit, out.fit, treat = "treat", mediator = "SWdens",robustSE = TRUE, sims = 100)
#detach("package:multilevelTools", unload=TRUE)
#detach("package:lmerTest", unload=TRUE)
SWS_data3<-SWS_data[SWS_data$Treatment=="PLA" | SWS_data$Treatment=="CIT",]
SWS_data3$Treatment<-droplevels(SWS_data3$Treatment)
SWS_data3$treat[SWS_data$Treatment]<-SWS_data3$Treatment=="CIT"
SWS_data3$treat<-as.integer(SWS_data3$treat)
med.fit <- lm(SWdens  ~ 1 + treat, data = SWS_data3)
out.fit <- lm(Miss  ~ 1 + SWdens + treat, data = SWS_data3)
med.out <- mediate(med.fit, out.fit, treat = "treat", mediator = "SWdens",robustSE = TRUE, sims = 100)
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(ggpubr)
library(car)
library(haven)
library(data.table)
library(visreg)
library(dplyr)
library(tidyr)
library(reshape2)
library(rstatix)
library(JWileymisc)
library(lme4)
library(lmerTest)
library(multilevelTools)
library(tidyverse)
SWS_data <- read.table("../Tables/CTET_SWdetection_thr90_byE_P2P_avDens_behav_vec_full_v3.txt", header = TRUE, sep = ",", stringsAsFactors = FALSE)
names(SWS_data)[names(SWS_data) == "Drug"] <- "Treatment"
SWS_data$Treatment<-as.factor(SWS_data$Treatment)
SWS_data$Treatment<-relevel(SWS_data$Treatment,"PLA")
SWS_data2<-aggregate(SWdens ~ SubID+Treatment+BlockN, data=SWS_data, FUN=mean)
##Slow wave density
lm.sw0 <- lmer(SWdens ~ 1 + (1|SubID), data = SWS_data2, REML =FALSE)
##Effects of block number on slow wave density
lm.sw1 <- lmer(SWdens  ~ 1  + BlockN + (1|SubID), data = SWS_data2, REML = FALSE)
##Effects of block number and drug on slow wave density
lm.sw2 <- lmer(SWdens  ~ 1  + BlockN + Treatment + (1|SubID), data = SWS_data2, REML = FALSE)
##Effects of the interaction between block number and drug on slow wave density
lm.sw3 <- lmer(SWdens  ~ 1 + BlockN*Treatment + (1|SubID), data = SWS_data2, REML = FALSE)
##Anova to see which one has the most interaction
anova(lm.sw0,lm.sw1,lm.sw2, lm.sw3)
lm.sw2 <- lmer(SWdens  ~ 1  + BlockN + Treatment + (1|SubID), data = SWS_data2, REML = TRUE)
summary(lm.sw2)
confint(lm.sw2, method = "Wald", oldNames = FALSE)
## Normality plot of residuals
hist(residuals(lm.sw2))
boxplot(residuals(lm.sw2))
qqnorm(resid(lm.sw2))
qqline(resid(lm.sw2))
plot(lm.sw2)
plot(fitted(lm.sw2), resid(lm.sw2))
#DRAFT
##Graph of the effects of block number and drug on slow wave density
sw.graph <- summarySE(SWS_data, measurevar = "SWdens", groupvars = c("BlockN", "Treatment"))
library(ggplot2)
library(ggpubr)
library(car)
library(haven)
library(data.table)
library(visreg)
library(dplyr)
library(tidyr)
library(reshape2)
library(rstatix)
library(JWileymisc)
library(lme4)
library(lmerTest)
library(multilevelTools)
library(tidyverse)
SWS_data <- read.table("../Tables/CTET_SWdetection_thr90_byE_P2P_avDens_behav_vec_full_v3.txt", header = TRUE, sep = ",", stringsAsFactors = FALSE)
names(SWS_data)[names(SWS_data) == "Drug"] <- "Treatment"
SWS_data$Treatment<-as.factor(SWS_data$Treatment)
SWS_data$Treatment<-relevel(SWS_data$Treatment,"PLA")
SWS_data2<-aggregate(SWdens ~ SubID+Treatment+BlockN, data=SWS_data, FUN=mean)
##Slow wave density
lm.sw0 <- lmer(SWdens ~ 1 + (1|SubID), data = SWS_data2, REML =FALSE)
##Effects of block number on slow wave density
lm.sw1 <- lmer(SWdens  ~ 1  + BlockN + (1|SubID), data = SWS_data2, REML = FALSE)
##Effects of block number and drug on slow wave density
lm.sw2 <- lmer(SWdens  ~ 1  + BlockN + Treatment + (1|SubID), data = SWS_data2, REML = FALSE)
##Effects of the interaction between block number and drug on slow wave density
lm.sw3 <- lmer(SWdens  ~ 1 + BlockN*Treatment + (1|SubID), data = SWS_data2, REML = FALSE)
##Anova to see which one has the most interaction
anova(lm.sw0,lm.sw1,lm.sw2, lm.sw3)
lm.sw2 <- lmer(SWdens  ~ 1  + BlockN + Treatment + (1|SubID), data = SWS_data2, REML = TRUE)
summary(lm.sw2)
confint(lm.sw2, method = "Wald", oldNames = FALSE)
## Normality plot of residuals
hist(residuals(lm.sw2))
boxplot(residuals(lm.sw2))
qqnorm(resid(lm.sw2))
qqline(resid(lm.sw2))
plot(lm.sw2)
plot(fitted(lm.sw2), resid(lm.sw2))
#DRAFT
##Graph of the effects of block number and drug on slow wave density
sw.graph <- summarySE(SWS_data, measurevar = "SWdens", groupvars = c("BlockN", "Treatment"))
##Graph of the effects of block number and drug on slow wave density
sw.graph <- summarySE(SWS_data2, measurevar = "SWdens", groupvars = c("BlockN", "Treatment"))
?summarySE
??summarySE
library(Rmisc)
library(ggplot2)
library(ggpubr)
library(car)
library(haven)
library(data.table)
library(visreg)
library(dplyr)
library(tidyr)
library(reshape2)
library(rstatix)
library(JWileymisc)
library(lme4)
library(lmerTest)
library(multilevelTools)
library(tidyverse)
library(Rmisc)
SWS_data <- read.table("../Tables/CTET_SWdetection_thr90_byE_P2P_avDens_behav_vec_full_v3.txt", header = TRUE, sep = ",", stringsAsFactors = FALSE)
names(SWS_data)[names(SWS_data) == "Drug"] <- "Treatment"
SWS_data$Treatment<-as.factor(SWS_data$Treatment)
SWS_data$Treatment<-relevel(SWS_data$Treatment,"PLA")
SWS_data2<-aggregate(SWdens ~ SubID+Treatment+BlockN, data=SWS_data, FUN=mean)
##Slow wave density
lm.sw0 <- lmer(SWdens ~ 1 + (1|SubID), data = SWS_data2, REML =FALSE)
##Effects of block number on slow wave density
lm.sw1 <- lmer(SWdens  ~ 1  + BlockN + (1|SubID), data = SWS_data2, REML = FALSE)
##Effects of block number and drug on slow wave density
lm.sw2 <- lmer(SWdens  ~ 1  + BlockN + Treatment + (1|SubID), data = SWS_data2, REML = FALSE)
##Effects of the interaction between block number and drug on slow wave density
lm.sw3 <- lmer(SWdens  ~ 1 + BlockN*Treatment + (1|SubID), data = SWS_data2, REML = FALSE)
##Anova to see which one has the most interaction
anova(lm.sw0,lm.sw1,lm.sw2, lm.sw3)
lm.sw2 <- lmer(SWdens  ~ 1  + BlockN + Treatment + (1|SubID), data = SWS_data2, REML = TRUE)
summary(lm.sw2)
confint(lm.sw2, method = "Wald", oldNames = FALSE)
## Normality plot of residuals
hist(residuals(lm.sw2))
boxplot(residuals(lm.sw2))
qqnorm(resid(lm.sw2))
qqline(resid(lm.sw2))
plot(lm.sw2)
plot(fitted(lm.sw2), resid(lm.sw2))
#DRAFT
##Graph of the effects of block number and drug on slow wave density
sw.graph <- summarySE(SWS_data, measurevar = "SWdens", groupvars = c("BlockN", "Treatment"))
sw.graph$Treatment<-ordered(sw.graph$Treatment, c("PLA","MPH","ATM","CIT"))
##Graph with Standard Error
ggplot(sw.graph, aes(x = BlockN, y = SWdens, colour = Treatment)) + geom_point() + geom_line() +  ggtitle("Mean Slow Wave Density According To Block Number and Treatment") + ylab("Mean Slow Wave Density") + xlab("Block Number")+ geom_ribbon(aes(ymin = SWdens-se, ymax = SWdens+se, fill = Treatment), alpha = .35, linetype = 0) + scale_fill_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77")) + scale_colour_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77")) + scale_x_continuous(breaks = c(1:10))
##Barplot
sw2.graph <- summarySE(SWS_data, measurevar = "SWdens", groupvars = c( "Treatment"))
sw2.graph$Treatment<-ordered(sw2.graph$Treatment,c("PLA","MPH","ATM","CIT"))
ggplot(data=sw2.graph, aes(x=Treatment, y=SWdens, fill = Treatment)) +
geom_bar(stat="identity") + geom_errorbar(aes(ymin = SWdens-se, ymax = SWdens+se), width = .5, size = .6) + scale_fill_discrete( name = "Treatment", breaks = c("PLA", "MPH", "ATM", "CIT"), labels = c("Placebo", "Methylphenidate", "Atomoxetine", "Citalopram")) + ylab("Mean Slow Wave Density")+ scale_fill_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77")) + coord_cartesian(ylim =c(4, 5)) + ggtitle("Mean Slow Wave Density For Each Treatment")
##Graph of the effects of block number and drug on slow wave density
sw.graph <- summarySE(SWS_data2, measurevar = "SWdens", groupvars = c("BlockN", "Treatment"))
sw.graph$Treatment<-ordered(sw.graph$Treatment, c("PLA","MPH","ATM","CIT"))
##Graph with Standard Error
ggplot(sw.graph, aes(x = BlockN, y = SWdens, colour = Treatment)) + geom_point() + geom_line() + xlab("Block Number")+ geom_ribbon(aes(ymin = SWdens-se, ymax = SWdens+se, fill = Treatment), alpha = .35, linetype = 0) + scale_fill_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77")) + scale_colour_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77")) + scale_x_continuous(breaks = c(1:10))+ scale_y_continuous(labels = scales::number_format(accuracy = .01)) + theme_classic() +theme(panel.border = element_blank(), legend.position = "none",axis.title=element_text(size=14),axis.text=element_text(size=14), axis.title.y = element_blank())
ggsave(file="../Figures/CTET_LinePlot_SWD.png",
width = 30/2,
height = 18/2,
units = c("cm"))
##Barplot
sw2.graph <- summarySE(SWS_data2, measurevar = "SWdens", groupvars = c( "Treatment"))
sw2.graph$Treatment<-ordered(sw2.graph$Treatment,c("PLA","MPH","ATM","CIT"))
ggplot(data=sw2.graph, aes(x=Treatment, y=SWdens, fill = Treatment)) +
geom_bar(stat="identity") + geom_errorbar(aes(ymin = SWdens-se, ymax = SWdens+se), width = .5, size = .6) + scale_fill_discrete( name = "Treatment", breaks = c("PLA", "MPH", "ATM", "CIT"), labels = c("Placebo", "Methylphenidate", "Atomoxetine", "Citalopram")) + ylab("Mean Slow Wave Density")+ scale_fill_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77")) + coord_cartesian(ylim =c(3.25, 5.5)) + scale_y_continuous(labels = scales::number_format(accuracy = .01)) + theme_classic()+theme(legend.position = "none",axis.title=element_text(size=14),axis.text=element_text(size=14), axis.title.x = element_blank())
ggsave(file="../Figures/CTET_BarPlot_SWD.png", dpi = 600,
width = 15/2,
height = 18/2,
units = c("cm"))
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(ggpubr)
library(car)
library(haven)
library(data.table)
library(visreg)
library(dplyr)
library(tidyr)
library(reshape2)
library(rstatix)
library(JWileymisc)
library(lme4)
library(lmerTest)
library(multilevelTools)
library(tidyverse)
library(Rmisc)
SWS_data4 <- read.table("../Tables/CTET_SWdetection_thr90_allE_P2P_avDens_behav_vec_full_v3.txt", header = TRUE, sep = ",", stringsAsFactors = FALSE)
SWS_data4 <- read.table("../Tables/CCTET_SWdetection_avDens_behav_vec_full_v2.txt", header = TRUE, sep = ",", stringsAsFactors = FALSE)
setwd("~/Desktop/PSY4100/LS_NeuroM/Tables")
library(ggplot2)
library(ggpubr)
library(car)
library(haven)
library(data.table)
library(visreg)
library(dplyr)
library(tidyr)
library(reshape2)
library(rstatix)
library(JWileymisc)
library(lme4)
library(lmerTest)
library(multilevelTools)
library(tidyverse)
library(Rmisc)
SWS_data4 <- read.table("../Tables/CCTET_SWdetection_avDens_behav_vec_full_v2.txt", header = TRUE, sep = ",", stringsAsFactors = FALSE)
SWS_data4 <- read.table("../Tables/CTET_SWdetection_avDens_behav_vec_full_v2.txt", header = TRUE, sep = ",", stringsAsFactors = FALSE)
View(SWS_data4)
SWS_data$Treatment<-relevel(SWS_data$Treatment,"PLA")
library(ggplot2)
library(ggpubr)
library(car)
library(haven)
library(data.table)
library(visreg)
library(dplyr)
library(tidyr)
library(reshape2)
library(rstatix)
library(JWileymisc)
library(lme4)
library(lmerTest)
library(multilevelTools)
library(tidyverse)
library(Rmisc)
SWS_data4 <- read.table("../Tables/CTET_SWdetection_avDens_behav_vec_full_v2.txt", header = TRUE, sep = ",", stringsAsFactors = FALSE)
names(SWS_data)[names(SWS_data) == "Drug"] <- "Treatment"
SWS_data$Treatment<-as.factor(SWS_data$Treatment)
SWS_data$Treatment<-relevel(SWS_data$Treatment,"PLA")
library(ggplot2)
library(ggpubr)
library(car)
library(haven)
library(data.table)
library(visreg)
library(dplyr)
library(tidyr)
library(reshape2)
library(rstatix)
library(JWileymisc)
library(lme4)
library(lmerTest)
library(multilevelTools)
library(tidyverse)
library(Rmisc)
SWS_data4 <- read.table("../Tables/CTET_SWdetection_avDens_behav_vec_full_v2.txt", header = TRUE, sep = ",", stringsAsFactors = FALSE)
names(SWS_data4)[names(SWS_data4) == "Drug"] <- "Treatment"
SWS_data4$Treatment<-as.factor(SWS_data4$Treatment)
SWS_data4$Treatment<-relevel(SWS_data4$Treatment,"PLA")
View(SWS_data4)
SWS_data4 <- read.table("../Tables/CTET_SWdetection_avDens_behav_vec_full_v3.txt", header = TRUE, sep = ",", stringsAsFactors = FALSE)
SWS_data4 <- read.table("../Tables/CTET_SWdetection_thr90_byE_P2P_avDens_behav_vec_full_v3.txt", header = TRUE, sep = ",", stringsAsFactors = FALSE)
library(ggplot2)
library(ggpubr)
library(car)
library(haven)
library(data.table)
library(visreg)
library(dplyr)
library(tidyr)
library(reshape2)
library(rstatix)
library(JWileymisc)
library(lme4)
library(lmerTest)
library(multilevelTools)
library(tidyverse)
library(Rmisc)
SWS_data4 <- read.table("../Tables/CTET_SWdetection_thr90_byE_P2P_avDens_behav_vec_full_v3.txt", header = TRUE, sep = ",", stringsAsFactors = FALSE)
names(SWS_data4)[names(SWS_data4) == "Drug"] <- "Treatment"
SWS_data4$Treatment<-as.factor(SWS_data4$Treatment)
SWS_data4$Treatment<-relevel(SWS_data4$Treatment,"PLA")
View(SWS_data4)
library(ggplot2)
library(ggpubr)
library(car)
library(haven)
library(data.table)
library(visreg)
library(dplyr)
library(tidyr)
library(reshape2)
library(rstatix)
library(JWileymisc)
library(lme4)
library(lmerTest)
library(multilevelTools)
library(tidyverse)
library(Rmisc)
SWS_data4 <- read.table("../Tables/CTET_SWdetection_thr90_byE_P2P_avDens_behav_vec_full_v3.txt", header = TRUE, sep = ",", stringsAsFactors = FALSE)
names(SWS_data4)[names(SWS_data4) == "Drug"] <- "Treatment"
SWS_data4$Treatment<-as.factor(SWS_data4$Treatment)
SWS_data4$Treatment<-relevel(SWS_data4$Treatment,"PLA")
blockN <- as.data.frame(SWS_data4[, 4])
dim(blockN)
blockN <- as.data.frame(SWS_data4[, 4])
dim(blockN)
for (block in 1:length(blockN)) {
variable <- blockN[, block]
lme_block <- lmer(SWdens ~ 1 + Treatment + variable + (1|SubID), REML = TRUE, data = SWS_data4)
print(summary(lme_block)$tTable)
}
length(blockN)
SWS_data4[,4]
dim(BlockN)
dim(blockN)
row(blockN)
blockN <- as.data.frame(SWS_data4[, 4])
dim(blockN)
for (block in 1:row(blockN)) {
variable <- blockN[, block]
lme_block <- lmer(SWdens ~ 1 + Treatment + variable + (1|SubID), REML = TRUE, data = SWS_data4)
print(summary(lme_block)$tTable)
}
length(blockN)
summary(SWS_data4[,4])
blockN
blockN
length(blockN)
for (block in 1:10 {
for (block in 1:10) {
variable <- blockN[, block]
lme_block <- lmer(SWdens ~ 1 + Treatment + variable + (1|SubID), REML = TRUE, data = SWS_data4)
print(summary(lme_block)$tTable)
}
for (block in c(1:10)) {
variable <- blockN[, block]
lme_block <- lmer(SWdens ~ 1 + Treatment + variable + (1|SubID), REML = TRUE, data = SWS_data4)
print(summary(lme_block)$tTable)
}
dim(blockN)
dim(blockN)
for (block in c(1:10),) {
blockN <- as.data.frame(SWS_data4[, 4])
dim(blockN)
for (block in 1:10) {
variable <- blockN[, block]
lme_block <- lmer(SWdens ~ 1 + Treatment + variable + (1|SubID), REML = TRUE, data = SWS_data4)
print(summary(lme_block)$tTable)
}
for (block in 1:length(blockN)) {
variable <- blockN[, block]
lme_block <- lmer(SWdens ~ 1 + Treatment + variable + (1|SubID), REML = TRUE, data = SWS_data4)
print(summary(lme_block)$tTable)
}
lme_block <- lmer(SWdens ~ 1 + Treatment + block + (1|SubID), REML = TRUE, data = SWS_data4)
blockN <- as.data.frame(SWS_data4[, 4])
dim(blockN)
for (i in 1:length(blockN)) {
block <- blockN[, i]
lme_block <- lmer(SWdens ~ 1 + Treatment + block + (1|SubID), REML = TRUE, data = SWS_data4)
print(summary(lme_block)$tTable)
}
i
for (i in 1:1280) {
block <- blockN[, i]
lme_block <- lmer(SWdens ~ 1 + Treatment + block + (1|SubID), REML = TRUE, data = SWS_data4)
print(summary(lme_block)$tTable)
}
print(summary(lme_block)$Table)
lme.swd <- lmer(SWdens ~ 1 + Treatment + block + (1|SubID), REML = TRUE, data = SWS_data4)
blockN <- as.data.frame(SWS_data4[,4])
blockN <- as.data.frame(SWS_data4[,4])
head(sblockN)
head(blockN)
blockN
blockN <- as.data.frame(SWS_data4[, 4])
dim(blockN)
for (i in 1:1280) {
lme_block <- lmer(SWdens ~ 1 + Treatment + block + (1|SubID), REML = TRUE, data = SWS_data4)
print(summary(lme_block)$Table)
}
blockN <- as.data.frame(SWS_data4[, 4])
dim(blockN)
for (i in 1:1280) {
lme_block <- lmer(SWdens ~ 1 + Treatment + block + (1|SubID), REML = TRUE, data = SWS_data4)
print(summary(lme_block)$Table)
}
dim(blockN)
dim(blockN)
for (blockN in seq_along(lme.swd)) {lme.swd[blockN]<- lme.swd[blockN]==c(1:10)}
for (blockN in seq_along(lme.swd)) {lme.swd[blockN] ==c(1:10)}
for (blockN in seq_along(lme.swd)) {blockN = c(1:10)}
for (blockN in seq_along(lme.swd)) {blockN = c(1:10)}
for (blockN in seq_along(lme.swd)) {blockN = c(1:10)}
lme.swd
for (blockN in seq_along(lme.swd)) {blockN = c(1:10)}
lme.swd
lme.swd <- lmer(SWdens ~ 1 + Treatment + blockN + (1|SubID), REML = TRUE, data = SWS_data4)
lme.swd <- lmer(SWdens ~ 1 + Treatment + blockN + (1|SubID), REML = TRUE, data = SWS_data4)
lme.swd <- lmer(SWdens ~ 1 + Treatment + block + (1|SubID), REML = TRUE, data = SWS_data4)
for (block in seq_along(lme.swd)) {block = c(1:10)}
lme.swd
for (block in seq_along(lme.swd)) {lme.swd[block] = c(1:10)}
lme.swd <- lmer(SWdens ~ 1 + Treatment + block + (1|SubID), REML = TRUE, data = SWS_data4)
lme.swd <- lmer(SWdens ~ 1 + Treatment + block + (1|SubID), REML = TRUE, data = SWS_data4)
for (block in seq_along(lme.swd)) {block = SWS_data4[,4]}
lme.swd <- lmer(SWdens ~ 1 + Treatment + block + (1|SubID), REML = TRUE, data = SWS_data4)
for (block in seq_along(lme.swd)) {block = SWS_data4[,4]}
lme.swd
