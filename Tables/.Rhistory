partial = FALSE, rug = FALSE, gg = TRUE) +
ylab("predicted probability of being high in self-esteem") +
theme_pubr() + coord_cartesian(expand=FALSE)
## odd ratios
exp(coef(s))
## 95% Confidence Interval
exp(confint(s))
## Average marginal effect
## pick h value for difference, store that in variable h
h <- .01
## make the original dataset
originaldata <- db[, .(extraversion, openness)]
## make the increased extraversion dataset (extraversion + h)
increasedExtraversion <- db[, .(extraversion = extraversion + h, openness)]
## make the increased openness dataset (openness + h)
increasedOpenness <- db[, .(extraversion, openness = openness + h)]
## calculate original predicted probabilities
originaldata$Prob <- predict(s, newdata = originaldata,
type = "response")
## calculate increased predicted probabilities for extraversion
increasedExtraversion$Prob <- predict(s, newdata = increasedExtraversion,
type = "response")
## calculate increased predicted probabilities for openness
increasedOpenness$Prob <- predict(s, newdata = increasedOpenness,
type = "response")
## calculate the difference in probabilities per unit
ex.diffprob <- (increasedExtraversion$Prob - originaldata$Prob) / h
op.diffprob <- (increasedOpenness$Prob - originaldata$Prob) / h
## calculate the average marginal effects
mean(ex.diffprob) # extraversion
mean(op.diffprob) # openness
## Re-run of the data with just extraversion
egltable(c("SelfesteemHigh", "extraversion"), data = db, strict = FALSE)
s1 <- glm(SelfesteemHigh ~ extraversion, data = db, family = binomial())
summary(s1)
##Odds Ratio
exp(coef(s1))
##95% Confidence Interval
exp(confint(s1))
visreg(s1, xvar = "extraversion", scale = "response", partial = FALSE, rug = FALSE, gg = TRUE) +
ylab("predicted probability of having high self-esteem") +
theme_pubr()
## Average marginal effect
## pick h value for difference, store that in variable h
h <- .01
## make the original dataset
originaldata1 <- db[, .(extraversion)]
## make the increased extraversion dataset (extraversion + h)
increasedExtraversion1 <- db[, .(extraversion = extraversion + h, openness)]
## calculate original predicted probabilities
originaldata1$Prob <- predict(s1, newdata = originaldata1,
type = "response")
## calculate increased predicted probabilities for extraversion
increasedExtraversion1$Prob <- predict(s1, newdata = increasedExtraversion1,
type = "response")
## calculate the difference in probabilities per unit
ex.diffprob1 <- (increasedExtraversion1$Prob - originaldata1$Prob) / h
## calculate the average marginal effects
mean(ex.diffprob1) # extraversion
data(aces_daily)
d <- as.data.table(aces_daily)
## between person data, no missing
davg <- na.omit(d[, .(
Female = factor(na.omit(Female)[1], levels = 0:1),
Age = na.omit(Age)[1],
STRESS = mean(STRESS, na.rm = TRUE),
PosAff = mean(PosAff, na.rm = TRUE),
NegAff = mean(NegAff, na.rm = TRUE)),
by = UserID])
## create missing data
davgmiss <- copy(davg)
davgmiss[STRESS < 1, NegAff := NA]
davgmiss[STRESS > 4, PosAff := NA]
## random missingness on age
set.seed(1234)
davgmiss[, Age := ifelse(rbinom(
.N, size = 1, prob = .1) == 1,
NA, Age)]
## drop unneeded variables to make analysis easier
davgmiss[, UserID := NULL]
##Generate imputed datasets
mi.1 <- mice(
davgmiss,
m = 5,   maxit = 3,
defaultMethod = c("norm", "logreg", "polyreg", "polr"),
seed = 1234, printFlag = FALSE)
## plot convergence diagnostics
plot(mi.1, PosAff + NegAff + Age ~ .it | .ms)
## run an additional iteration
mi.1 <- mice.mids(
mi.1, maxit = 20,
printFlag = FALSE)
plot(mi.1, PosAff + NegAff + Age ~ .it | .ms)
##Plot of the imputed data versus observed data
densityplot(mi.1, ~ PosAff + NegAff + Age)
xyplot(mi.1, NegAff + PosAff + Age ~ STRESS)
##Use with() and pool()
mi.reg <- with(mi.1, lm(PosAff ~ NegAff))
mi.reg
pool(mi.reg)
##summary
summary(pool(mi.reg), conf.int = TRUE)
## r-squared values
pool.r.squared(mi.reg)
library(lme4)
library(lmerTest)
library(JWileymisc)
library(multilevelTools)
data(aces_daily)
d <- as.data.table(aces_daily)
##Intercept only linear mixed model with Positive Affect ratings as the outcome variable
lm.PosAff <- lmer(PosAff ~ 1 + (1|UserID), data = aces_daily, REML = TRUE)
summary(lm.PosAff)
##Intraclass correlation coefficient
iccMixed("PosAff", id = "UserID", data =aces_daily)
##Model diagnostics
plot(modelDiagnostics(lm.PosAff), ncol = 2, nrow = 2, ask = FALSE)
##Confidence intervals
confint(lm.PosAff, method = "profile", oldNames = FALSE)
##Intraclass correlation coefficient
iccMixed("PosAff", id = "UserID", data =aces_daily)
##Model diagnostics
plot(modelDiagnostics(lm.PosAff), ncol = 2, nrow = 2, ask = FALSE)
##Create a between and within version of Stress
d[, c("Bstress", "Wstress") := meanDeviations(STRESS), by = UserID]
##Linear mixed model
lm.support <- lmer(SUPPORT ~ Bstress + Wstress + (Wstress|UserID), data = d, REML = TRUE)
summary(lm.support)
##Model Diagnostics
lm.support.diag <- modelDiagnostics(lm.support, ev.perc = .005)
plot(lm.support.diag, ncol = 2, nrow = 3, ask = FALSE)
##Exlcuding outliers
lm.support.diag$extremeValues
lm.support1 <- lmer(SUPPORT ~ Bstress + Wstress + (Wstress|UserID), data = d[-lm.support.diag$extremeValues$Index])
lm.support.diag1 <- modelDiagnostics(lm.support1, ev.perc = .005)
plot(lm.support.diag1, ncol = 2, nrow = 3, ask = FALSE)
lm.support.diag1$extremeValues
##New summary of model
summary(lm.support1)
confint(lm.support1,  method = "Wald", oldNames = FALSE)
##Model Diagnostics
lm.support.diag <- modelDiagnostics(lm.support, ev.perc = .005)
plot(lm.support.diag, ncol = 2, nrow = 3, ask = FALSE)
##New summary of model
summary(lm.support1)
summary(lm.support1)
confint(lm.support1,  method = "Wald", oldNames = FALSE)
library(emmeans)
##Linear mixed model of the interaction between stress and education on positive affect ratings
pos.aff <- lmer(PosAff ~ STRESS*NegAff + (1|UserID), data = d, REML = TRUE)
summary(pos.aff)
modelDiagnostics(pos.aff)
##Mean and standard deviation of stress
egltable("STRESS", data = d)
##Graph of the effects of stress, education and their interaction, on positive affect
visreg(pos.aff, xvar = "NegAff", b= "STRESS", overlay = TRUE, breaks = c(2.33+2.51, 2.33 + 2*2.51), partial = FALSE,  gg = TRUE, rug = FALSE, xlab = "Negative Affect", ylab = "Predicted Sessional Positive Affect")
library(JWileymisc)
data(aces_daily)
d <- as.data.table(aces_daily)
##The effects of positive affect on negative affect
neg.aff0 <- lmer(NegAff ~ 1 + (1|UserID), data = d[!is.na(PosAff)], REML = FALSE)
neg.aff1 <- lmer(NegAff ~ poly(PosAff, 1) + (1|UserID), data = d[!is.na(PosAff)], REML = FALSE)
neg.aff2 <- lmer(NegAff ~ poly(PosAff, 2) + (1|UserID), data = d[!is.na(PosAff)], REML = FALSE)
neg.aff3 <- lmer(NegAff ~ poly(PosAff, 3) + (1|UserID), data = d[!is.na(PosAff)], REML = FALSE)
nobs(neg.aff0)
nobs(neg.aff1)
nobs(neg.aff2)
nobs(neg.aff3)
##Finding the model that best fit the data
anova(neg.aff0, neg.aff1, neg.aff2, neg.aff3, test = "LRT")
modelDiagnostics(neg.aff2)
summary(neg.aff2)
APAStyler(modelTest(neg.aff2))
The quadratic function of positive affect on negative affect (neg.aff2) had the best model fit as it had the lowest Akaike information criterion (AIC) and a significant Chi-squared value (p <.001). There is a significant negative linear association between positive affect and negative affect (*b* [95 % CI] = -24.96, [-26.31, -23.61], p <.001) and a significant positive quadratic association between positive and negative affect (*b* [95 % CI] = 5.17 [4.05, 6.29], p <.001) with a medium effect size for the fixed effects, *f^2* = .25, and a medium effect size for the conditional model, *f^2* = .31.
##REFERENCE GRAPH
ggplot(fa.graph, aes(x = BlockN, y = FA, colour = Treatment)) + geom_point() + geom_line() + scale_colour_brewer(palette = "Dark2") + scale_fill_brewer(palette = "Dark2") + ggtitle("False alarms according to block number and treatment") + ylab("False Alarms") + xlab("Block Number") + xlim(0, 10.5) + ylim(0, 0.01)
##REFERENCE GRAPH
ggplot(fa.graph, aes(x = BlockN, y = FA, colour = Treatment)) + geom_point() + geom_line() + scale_colour_brewer(palette = "Dark2") + scale_fill_brewer(palette = "Dark2") + ggtitle("False alarms according to block number and treatment") + ylab("False Alarms") + xlab("Block Number") + xlim(0, 10.5) + ylim(0, 0.01)
##Graph with Standard Error
ggplot(fa.graph, aes(x = BlockN, y = FA, colour = Treatment)) + geom_point() + geom_line() +  ggtitle("False alarms according to block number and treatment") + ylab("Mean False Alarms") + xlab("Block Number") + xlim(0, 10.5) + ylim(0, 0.01) + geom_ribbon(aes(ymin = FA-se, ymax = FA+se, fill = Treatment), alpha = .35, linetype = 0) + scale_fill_manual(values = c("#666666", "#990000", "#CC0000", "#000099")) + scale_colour_manual(values = c("#666666", "#990000", "#FF0000", "#000099"))
##Graph with Standard Error
ggplot(fa.graph, aes(x = BlockN, y = FA, colour = Treatment)) + geom_point() + geom_line() +  ggtitle("False alarms according to block number and treatment") + ylab("Mean False Alarms") + xlab("Block Number") + xlim(0, 10.5) + ylim(-1, 0.02) + geom_ribbon(aes(ymin = FA-se, ymax = FA+se, fill = Treatment), alpha = .35, linetype = 0) + scale_fill_manual(values = c("#666666", "#990000", "#CC0000", "#000099")) + scale_colour_manual(values = c("#666666", "#990000", "#FF0000", "#000099"))
##Graph with Standard Error
ggplot(fa.graph, aes(x = BlockN, y = FA, colour = Treatment)) + geom_point() + geom_line() +  ggtitle("False alarms according to block number and treatment") + ylab("Mean False Alarms") + xlab("Block Number") + xlim(0, 10.5) + ylim(0, 0.02) + geom_ribbon(aes(ymin = FA-se, ymax = FA+se, fill = Treatment), alpha = .35, linetype = 0) + scale_fill_manual(values = c("#666666", "#990000", "#CC0000", "#000099")) + scale_colour_manual(values = c("#666666", "#990000", "#FF0000", "#000099"))
##Graph with Standard Error
ggplot(fa.graph, aes(x = BlockN, y = FA, colour = Treatment)) + geom_point() + geom_line() +  ggtitle("False alarms according to block number and treatment") + ylab("Mean False Alarms") + xlab("Block Number") + xlim(0, 10.5) + ylim(0, 0.13) + geom_ribbon(aes(ymin = FA-se, ymax = FA+se, fill = Treatment), alpha = .35, linetype = 0) + scale_fill_manual(values = c("#666666", "#990000", "#CC0000", "#000099")) + scale_colour_manual(values = c("#666666", "#990000", "#FF0000", "#000099"))
##Graph with Standard Error
ggplot(fa.graph, aes(x = BlockN, y = FA, colour = Treatment)) + geom_point() + geom_line() +  ggtitle("False alarms according to block number and treatment") + ylab("Mean False Alarms") + xlab("Block Number") + xlim(0, 10.5) + ylim(0., 0.013) + geom_ribbon(aes(ymin = FA-se, ymax = FA+se, fill = Treatment), alpha = .35, linetype = 0) + scale_fill_manual(values = c("#666666", "#990000", "#CC0000", "#000099")) + scale_colour_manual(values = c("#666666", "#990000", "#FF0000", "#000099"))
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(ggpubr)
library(car)
library(haven)
library(data.table)
library(visreg)
library(dplyr)
library(tidyr)
library(reshape2)
library(rstatix)
library(JWileymisc)
library(lme4)
library(lmerTest)
library(multilevelTools)
library(tidyverse)
library(remotes)
remotes::install_github("neuroconductor/eegUtils")
library(ggplot2)
library(ggpubr)
library(car)
library(haven)
library(data.table)
library(visreg)
library(dplyr)
library(tidyr)
library(reshape2)
library(rstatix)
library(JWileymisc)
library(lme4)
library(lmerTest)
library(multilevelTools)
library(tidyverse)
SWS_data <- read.table("../Tables/CTET_SWdetection_thr90_allE_P2P_vec.txt", header = TRUE, sep = ",", stringsAsFactors = FALSE)
names(SWS_data)[names(SWS_data) == "Drug"] <- "Treatment"
SWS_data$Treatment<-as.factor(SWS_data$Treatment)
SWS_data$Treatment<-relevel(SWS_data$Treatment,"PLA")
##Summary descriptive statistics (mean/SD, or number/frequency)
egltable(c("Treatment", "SWdens", "Elec"), data = SWS_data, strict=FALSE)
lm.sw0 <- lmer(SWdens ~ 1 + (1|SubID), data = SWS_data, REML = TRUE)
##Effects of drug on slow wave density
lm.sw1 <- lmer(SWdens  ~ 1 + Treatment + (1|SubID), data = SWS_data, REML = TRUE)
##Effects of drug and electrode interaction on slow wave density
lm.sw2 <- lmer(SWdens  ~ 1 + Treatment * Elec + (1|SubID), data = SWS_data, REML = TRUE)
##Slow wave density
lm.sw0 <- lmer(SWdens ~ 1 + (1|SubID), data = SWS_data, REML =FALSE)
##Effects of drug on slow wave density
lm.sw1 <- lmer(SWdens  ~ 1 + Treatment + (1|SubID), data = SWS_data, REML = FALSE)
##Effects of drug and electrode interaction on slow wave density
lm.sw2 <- lmer(SWdens  ~ 1 + Treatment * Elec + (1|SubID), data = SWS_data, REML = FALSE)
lm.sw0 <- lmer(SWdens ~ 1 + (1|SubID), data = SWS_data, REML =FALSE)
##Effects of drug on slow wave density
lm.sw1 <- lmer(SWdens  ~ 1 + Treatment + (1|SubID), data = SWS_data, REML = FALSE)
##Effects of drug and electrode interaction on slow wave density
lm.sw2 <- lmer(SWdens  ~ 1 + Treatment * Elec + (1|SubID), data = SWS_data, REML = FALSE)
##Anova to see which one has the most interaction
anova(lm.sw0,lm.sw1,lm.sw2)
View(SWS_data)
knitr::opts_chunk$set(echo = TRUE)
SWS_data <- read.table("../Tables/CTET_SWdetection_thr90_allE_P2P_vec.txt", header = TRUE, sep = ",", stringsAsFactors = FALSE)
library(ggplot2)
library(ggpubr)
library(car)
library(haven)
library(data.table)
library(visreg)
library(dplyr)
library(tidyr)
library(reshape2)
library(rstatix)
library(JWileymisc)
library(lme4)
library(lmerTest)
library(multilevelTools)
library(tidyverse)
SWS_data <- read.table("../Tables/CTET_SWdetection_thr90_allE_P2P_vec.txt", header = TRUE, sep = ",", stringsAsFactors = FALSE)
setwd("~/Desktop/PSY4100/LS_NeuroM/Tables")
library(ggplot2)
library(ggpubr)
library(car)
library(haven)
library(data.table)
library(visreg)
library(dplyr)
library(tidyr)
library(reshape2)
library(rstatix)
library(JWileymisc)
library(lme4)
library(lmerTest)
library(multilevelTools)
library(tidyverse)
SWS_data <- read.table("../Tables/CTET_SWdetection_thr90_allE_P2P_vec.txt", header = TRUE, sep = ",", stringsAsFactors = FALSE)
names(SWS_data)[names(SWS_data) == "Drug"] <- "Treatment"
SWS_data$Treatment<-as.factor(SWS_data$Treatment)
SWS_data$Treatment<-relevel(SWS_data$Treatment,"PLA")
View(SWS_data)
View(SWS_data)
##Slow wave density
lm.sw0 <- lmer(SWdens ~ 1 + (1|SubID), data = SWS_data, REML =FALSE)
##Effects of electrode placement on slow wave density
lm.sw1 <- lmer(SWdens  ~ 1 + Elec + (1|SubID), data = SWS_data, REML = FALSE)
##Effects of electrode placement and block number on slow wave density
lm.sw2 <- lmer(SWdens  ~ 1 + Elec + BlockN + (1|SubID), data = SWS_data, REML = FALSE)
##Effects of electrode placement, block number and drug on slow wave density
lm.sw3 <- lmer(SWdens  ~ 1 + Elec + BlockN + Treatment + (1|SubID), data = SWS_data, REML = FALSE)
##Effects of electrode placement interacting between block number and drug on slow wave density
lm.sw4 <- lmer(SWdens  ~ 1 + Elec*(BlockN + Treatment) + (1|SubID), data = SWS_data, REML = FALSE)
##Effects of the interaction between electrode placement, block number and drug on slow wave density
lm.sw5 <- lmer(SWdens  ~ 1 + Elec*BlockN*Treatment + (1|SubID), data = SWS_data, REML = FALSE)
##Anova to see which one has the most interaction
anova(lm.sw0,lm.sw1,lm.sw2, lm.sw3, lm.sw4, lm.sw5)
lm.sw4 <- lmer(SWdens  ~ 1 + Elec*(BlockN + Treatment) + (1|SubID), data = SWS_data, REML = TRUE)
summary(lm.sw4)
confint(lm.sw4, method = "Wald", oldNames = FALSE)
## Normality plot of residuals
hist(residuals(lm.sw4))
boxplot(residuals(lm.sw4))
qqnorm(resid(lm.sw4))
qqline(resid(lm.sw4))
plot(lm.sw4)
plot(fitted(lm.sw4), resid(lm.sw4))
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(ggpubr)
library(car)
library(haven)
library(data.table)
library(visreg)
library(dplyr)
library(tidyr)
library(reshape2)
library(rstatix)
library(JWileymisc)
library(lme4)
library(lmerTest)
library(multilevelTools)
library(ggstance)
library(jtools)
library(broom.mixed)
library(sjPlot)
library(glmmTMB)
library(lattice)
library(arm)
library(plyr)
library(Rmisc)
library(plotly)
##NOT WORKING:  CTET_Behaviour1 <- read.table("../Tables/CTET_behav_resblock.txt", header = TRUE, sep = ",", stringsAsFactors = FALSE)
CTET_Behaviour1 <- read.csv("../Tables/CTET_behav_resblock.txt")
CTET_Behaviour1$SubID<-as.factor(CTET_Behaviour1$SubID)
CTET_Behaviour1$Treatment<-as.factor(CTET_Behaviour1$Treatment)
CTET_Behaviour1<-CTET_Behaviour1[as.numeric(CTET_Behaviour1$BlockN)<11,]
CTET_Behaviour1$BlockN<-as.numeric(CTET_Behaviour1$BlockN)
CTET_Behaviour1$Treatment<-relevel(CTET_Behaviour1$Treatment,"PLA")
CTET_Behaviour1<-CTET_Behaviour1[!is.na(CTET_Behaviour1$BlockN),]
##Graph of the interaction between treatment and block number on false alarms
fa.graph <- summarySE(CTET_Behaviour1, measurevar = "FA", groupvars = c("BlockN", "Treatment"))
fa.graph$Treatment<-ordered(fa.graph$Treatment, c("PLA","MPH","ATM","CIT"))
##REFERENCE GRAPH
ggplot(fa.graph, aes(x = BlockN, y = FA, colour = Treatment)) + geom_point() + geom_line() + scale_colour_brewer(palette = "Dark2") + scale_fill_brewer(palette = "Dark2") + ggtitle("False alarms according to block number and treatment") + ylab("False Alarms") + xlab("Block Number") + xlim(0, 10.5) + ylim(0, 0.01)
##Graph with Standard Error
ggplot(fa.graph, aes(x = BlockN, y = FA, colour = Treatment)) + geom_point() + geom_line() +  ggtitle("False alarms according to block number and treatment") + ylab("Mean False Alarms") + xlab("Block Number") + xlim(0, 10.5) + ylim(0, 0.011) + geom_ribbon(aes(ymin = FA-se, ymax = FA+se, fill = Treatment), alpha = .35, linetype = 0) + scale_fill_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77")) + scale_colour_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77"))
##Barplot
fa2.graph <- summarySE(CTET_Behaviour1, measurevar = "FA", groupvars = c( "Treatment"))
fa2.graph$FA<-fa2.graph$FA
fa2.graph$Treatment<-ordered(fa2.graph$Treatment,c("PLA","MPH","ATM","CIT"))
ggplot(data=fa2.graph, aes(x=Treatment, y=FA, fill = Treatment)) +
geom_bar(stat="identity") + geom_errorbar(aes(ymin = FA-se, ymax = FA+se), width = .4, size = .45) + scale_fill_discrete( name = "Treatment", breaks = c("PLA", "MPH", "ATM", "CIT"), labels = c("Placebo", "Methylphenidate", "Atomoxetine", "Citalopram")) + ylab("Mean False Alarm")+ scale_fill_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77"))
##Graph of the interaction between treatment and block number on missed targets
miss.graph <- summarySE(CTET_Behaviour1, measurevar = "Miss", groupvars = c("BlockN", "Treatment"), na.rm = TRUE)
miss.graph$Treatment<-ordered(miss.graph$Treatment,c("PLA","MPH","ATM","CIT"))
##Reference graph
ggplot(miss.graph, aes(x = BlockN, y = Miss, colour = Treatment)) + geom_point() + geom_line() + scale_colour_brewer(palette = "Dark2") + scale_fill_brewer(palette = "Dark2") + ggtitle("Missed targets according to block number and treatment") + ylab("Missed Target") + xlab("Block Number") + xlim(0, 12) + ylim(0, 0.5)
##Graph with Standard Error
ggplot(miss.graph, aes(x = BlockN, y = Miss, colour = Treatment)) + geom_point() + geom_line() + ggtitle("Missed targets according to block number and treatment") + ylab("Mean Missed Targets") + xlab("Block Number") + xlim(0, 11) + ylim(0.1, 0.5) + geom_ribbon(aes(ymin = Miss-se, ymax = Miss+se, fill = Treatment), alpha = .35, linetype = 0) + scale_fill_manual(values = c("#666666", "#990000", "#CC0000", "#000099")) + scale_colour_manual(values = c("#666666", "#990000", "#FF0000", "#000099"))
##Barplot
miss2.graph <- summarySE(CTET_Behaviour1, measurevar = "Miss", groupvars = c("Treatment"), na.rm = TRUE)
miss2.graph$Treatment<-ordered(miss2.graph$Treatment,c("PLA","MPH","ATM","CIT"))
ggplot(data= miss2.graph, aes(x=Treatment, y=Miss, fill = Treatment)) +
geom_bar(stat="identity") + geom_errorbar(aes(ymin = Miss-se, ymax = Miss+se), width = .35, size = .6)  + scale_fill_manual(values = c("#666666", "#990000", "#CC0000", "#000099")) + labs (title = "Bar Plot of The Mean Misses Per Treatment", y = "Mean Misses")
sw.graph <- summarySE(SWS_data, measurevar = "SWdens", groupvars = c("BlockN", "Treatment"))
sw.graph$Treatment<-ordered(sw.graph$Treatment, c("PLA","MPH","ATM","CIT"))
ggplot(sw.graph, aes(x = BlockN, y = SWdens, colour = Treatment)) + geom_point() + geom_line() +  ggtitle("Slow wave density according to block number and treatment") + ylab("Mean Slow Wave Density") + xlab("Block Number") + xlim(0, 10.5) + ylim(0, 0.011) + geom_ribbon(aes(ymin = SWdens-se, ymax = SWdens+se, fill = Treatment), alpha = .35, linetype = 0) + scale_fill_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77")) + scale_colour_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77"))
##Graph with Standard Error
ggplot(sw.graph, aes(x = BlockN, y = SWdens, colour = Treatment)) + geom_point() + geom_line() +  ggtitle("Slow wave density according to block number and treatment") + ylab("Mean Slow Wave Density") + xlab("Block Number")+ geom_ribbon(aes(ymin = SWdens-se, ymax = SWdens+se, fill = Treatment), alpha = .35, linetype = 0) + scale_fill_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77")) + scale_colour_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77"))
sw2.graph <- summarySE(SWS_data, measurevar = "SWdens", groupvars = c( "Treatment"))
sw2.graph$Treatment<-ordered(sw2.graph$Treatment,c("PLA","MPH","ATM","CIT"))
ggplot(data=sw2.graph, aes(x=Treatment, y=SWdens, fill = Treatment)) +
geom_bar(stat="identity") + geom_errorbar(aes(ymin = SWdens-se, ymax = SWdens+se), width = .4, size = .45) + scale_fill_discrete( name = "Treatment", breaks = c("PLA", "MPH", "ATM", "CIT"), labels = c("Placebo", "Methylphenidate", "Atomoxetine", "Citalopram")) + ylab("Mean Slow Wave Density")+ scale_fill_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77"))
ggplot(data= rt2.graph, aes(x=Treatment, y=Hit_RT, fill = Treatment)) +
geom_bar(stat="identity") + geom_errorbar(aes(ymin = Hit_RT-se, ymax = Hit_RT+se), width = .4, size = .5) + scale_fill_manual(values = c("#666666", "#990000", "#CC0000", "#000099")) + ylim(0, 2) + labs(title = "Bar Plot of The Mean RT for Hits Per Treatment", y = "Mean RT Hit") + coord_cartesian(ylim =c(1.35, 1.45))
##Graph of the interaction between treatment and block number on hit rates
rt.graph <- summarySE(CTET_Behaviour1, measurevar = "Hit_RT", groupvars = c("BlockN", "Treatment"), na.rm = TRUE)
rt.graph$Treatment<-ordered(rt.graph$Treatment,c("PLA","MPH","ATM","CIT"))
##Reference graph
ggplot(rt.graph, aes(x = BlockN, y = Hit_RT, colour = Treatment)) + geom_point() + geom_line() + scale_colour_brewer(palette = "Dark2") + scale_fill_brewer(palette = "Dark2") + ggtitle("Mean RT for Hits according to block number and treatment") + ylab("Hit Rate") + xlab("Block Number") + xlim(0, 11) + ylim(1.3, 1.5)
##Graph with Standard Error
ggplot(rt.graph, aes(x = BlockN, y = Hit_RT, colour = Treatment)) + geom_point() + geom_line(alpha = .7) +  ggtitle("Mean RT for Hits according to block number and treatment") + ylab("Mean RT Hit") + xlab("Block Number") + xlim(0, 11) + ylim(1.3, 1.5) + geom_ribbon(aes(ymin = Hit_RT-se, ymax = Hit_RT+se, fill = Treatment), alpha = .35, linetype = 0) + scale_fill_manual(values = c("#666666", "#990000", "#CC0000", "#000099")) + scale_colour_manual(values = c("#666666", "#990000", "#FF0000", "#000099"))
##Bar plot
rt2.graph <- summarySE(CTET_Behaviour1, measurevar = "Hit_RT", groupvars = c("Treatment"), na.rm = TRUE)
rt2.graph$Treatment<-ordered(rt2.graph$Treatment,c("PLA","MPH","ATM","CIT"))
ggplot(data= rt2.graph, aes(x=Treatment, y=Hit_RT, fill = Treatment)) +
geom_bar(stat="identity") + geom_errorbar(aes(ymin = Hit_RT-se, ymax = Hit_RT+se), width = .4, size = .5) + scale_fill_manual(values = c("#666666", "#990000", "#CC0000", "#000099")) + ylim(0, 2) + labs(title = "Bar Plot of The Mean RT for Hits Per Treatment", y = "Mean RT Hit") + coord_cartesian(ylim =c(1.35, 1.45))
ggplot(data=sw2.graph, aes(x=Treatment, y=SWdens, fill = Treatment)) +
geom_bar(stat="identity") + geom_errorbar(aes(ymin = SWdens-se, ymax = SWdens+se), width = .4, size = .45) + scale_fill_discrete( name = "Treatment", breaks = c("PLA", "MPH", "ATM", "CIT"), labels = c("Placebo", "Methylphenidate", "Atomoxetine", "Citalopram")) + ylab("Mean Slow Wave Density")+ scale_fill_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77")) + coord_cartesian(ylim =c(4, 5.45))
ggplot(data=sw2.graph, aes(x=Treatment, y=SWdens, fill = Treatment)) +
geom_bar(stat="identity") + geom_errorbar(aes(ymin = SWdens-se, ymax = SWdens+se), width = .4, size = .45) + scale_fill_discrete( name = "Treatment", breaks = c("PLA", "MPH", "ATM", "CIT"), labels = c("Placebo", "Methylphenidate", "Atomoxetine", "Citalopram")) + ylab("Mean Slow Wave Density")+ scale_fill_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77")) + coord_cartesian(ylim =c(3, 5.45))
ggplot(data=sw2.graph, aes(x=Treatment, y=SWdens, fill = Treatment)) +
geom_bar(stat="identity") + geom_errorbar(aes(ymin = SWdens-se, ymax = SWdens+se), width = .4, size = .45) + scale_fill_discrete( name = "Treatment", breaks = c("PLA", "MPH", "ATM", "CIT"), labels = c("Placebo", "Methylphenidate", "Atomoxetine", "Citalopram")) + ylab("Mean Slow Wave Density")+ scale_fill_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77")) + coord_cartesian(ylim =c(3.5, 5))
ggplot(data=sw2.graph, aes(x=Treatment, y=SWdens, fill = Treatment)) +
geom_bar(stat="identity") + geom_errorbar(aes(ymin = SWdens-se, ymax = SWdens+se), width = .4, size = .5) + scale_fill_discrete( name = "Treatment", breaks = c("PLA", "MPH", "ATM", "CIT"), labels = c("Placebo", "Methylphenidate", "Atomoxetine", "Citalopram")) + ylab("Mean Slow Wave Density")+ scale_fill_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77")) + coord_cartesian(ylim =c(3.5, 5))
ggplot(data=sw2.graph, aes(x=Treatment, y=SWdens, fill = Treatment)) +
geom_bar(stat="identity") + geom_errorbar(aes(ymin = SWdens-se, ymax = SWdens+se), width = .8, size = .5) + scale_fill_discrete( name = "Treatment", breaks = c("PLA", "MPH", "ATM", "CIT"), labels = c("Placebo", "Methylphenidate", "Atomoxetine", "Citalopram")) + ylab("Mean Slow Wave Density")+ scale_fill_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77")) + coord_cartesian(ylim =c(3.5, 5))
ggplot(data=sw2.graph, aes(x=Treatment, y=SWdens, fill = Treatment)) +
geom_bar(stat="identity") + geom_errorbar(aes(ymin = SWdens-se, ymax = SWdens+se), width = .6, size = .5) + scale_fill_discrete( name = "Treatment", breaks = c("PLA", "MPH", "ATM", "CIT"), labels = c("Placebo", "Methylphenidate", "Atomoxetine", "Citalopram")) + ylab("Mean Slow Wave Density")+ scale_fill_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77")) + coord_cartesian(ylim =c(3.5, 5))
ggplot(data=sw2.graph, aes(x=Treatment, y=SWdens, fill = Treatment)) +
geom_bar(stat="identity") + geom_errorbar(aes(ymin = SWdens-se, ymax = SWdens+se), width = .6, size = .54) + scale_fill_discrete( name = "Treatment", breaks = c("PLA", "MPH", "ATM", "CIT"), labels = c("Placebo", "Methylphenidate", "Atomoxetine", "Citalopram")) + ylab("Mean Slow Wave Density")+ scale_fill_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77")) + coord_cartesian(ylim =c(3.5, 5))
ggplot(data=sw2.graph, aes(x=Treatment, y=SWdens, fill = Treatment)) +
geom_bar(stat="identity") + geom_errorbar(aes(ymin = SWdens-se, ymax = SWdens+se), width = .6, size = .3) + scale_fill_discrete( name = "Treatment", breaks = c("PLA", "MPH", "ATM", "CIT"), labels = c("Placebo", "Methylphenidate", "Atomoxetine", "Citalopram")) + ylab("Mean Slow Wave Density")+ scale_fill_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77")) + coord_cartesian(ylim =c(3.5, 5))
ggplot(data=sw2.graph, aes(x=Treatment, y=SWdens, fill = Treatment)) +
geom_bar(stat="identity") + geom_errorbar(aes(ymin = SWdens-se, ymax = SWdens+se), width = .6, size = .7) + scale_fill_discrete( name = "Treatment", breaks = c("PLA", "MPH", "ATM", "CIT"), labels = c("Placebo", "Methylphenidate", "Atomoxetine", "Citalopram")) + ylab("Mean Slow Wave Density")+ scale_fill_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77")) + coord_cartesian(ylim =c(3.5, 5))
ggplot(data=sw2.graph, aes(x=Treatment, y=SWdens, fill = Treatment)) +
geom_bar(stat="identity") + geom_errorbar(aes(ymin = SWdens-se, ymax = SWdens+se), width = .6, size = .6) + scale_fill_discrete( name = "Treatment", breaks = c("PLA", "MPH", "ATM", "CIT"), labels = c("Placebo", "Methylphenidate", "Atomoxetine", "Citalopram")) + ylab("Mean Slow Wave Density")+ scale_fill_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77")) + coord_cartesian(ylim =c(3.5, 5))
ggplot(data=sw2.graph, aes(x=Treatment, y=SWdens, fill = Treatment)) +
geom_bar(stat="identity") + geom_errorbar(aes(ymin = SWdens-se, ymax = SWdens+se), width = .5, size = .6) + scale_fill_discrete( name = "Treatment", breaks = c("PLA", "MPH", "ATM", "CIT"), labels = c("Placebo", "Methylphenidate", "Atomoxetine", "Citalopram")) + ylab("Mean Slow Wave Density")+ scale_fill_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77")) + coord_cartesian(ylim =c(3.5, 5))
ggplot(data=sw2.graph, aes(x=Treatment, y=SWdens, fill = Treatment)) +
geom_bar(stat="identity") + geom_errorbar(aes(ymin = SWdens-se, ymax = SWdens+se), width = 1, size = .6) + scale_fill_discrete( name = "Treatment", breaks = c("PLA", "MPH", "ATM", "CIT"), labels = c("Placebo", "Methylphenidate", "Atomoxetine", "Citalopram")) + ylab("Mean Slow Wave Density")+ scale_fill_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77")) + coord_cartesian(ylim =c(3.5, 5))
ggplot(data=sw2.graph, aes(x=Treatment, y=SWdens, fill = Treatment)) +
geom_bar(stat="identity") + geom_errorbar(aes(ymin = SWdens-se, ymax = SWdens+se), width = .5, size = .6) + scale_fill_discrete( name = "Treatment", breaks = c("PLA", "MPH", "ATM", "CIT"), labels = c("Placebo", "Methylphenidate", "Atomoxetine", "Citalopram")) + ylab("Mean Slow Wave Density")+ scale_fill_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77")) + coord_cartesian(ylim =c(3.5, 5))
ggplot(data=sw2.graph, aes(x=Treatment, y=SWdens, fill = Treatment)) +
geom_bar(stat="identity") + geom_errorbar(aes(ymin = SWdens-se, ymax = SWdens+se), width = .5, size = .6) + scale_fill_discrete( name = "Treatment", breaks = c("PLA", "MPH", "ATM", "CIT"), labels = c("Placebo", "Methylphenidate", "Atomoxetine", "Citalopram")) + ylab("Mean Slow Wave Density")+ scale_fill_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77")) + coord_cartesian(ylim =c(4, 5))
---
title: "SWS_Treatment_v3"
author: "Elaine P."
date: "16/06/2020"
output: html_document
---
##Graph of the effects of block number and drug on slow wave density
sw.graph <- summarySE(SWS_data, measurevar = "SWdens", groupvars = c("BlockN", "Treatment"))
##Graph of the effects of block number and drug on slow wave density
sw.graph <- summarySE(SWS_data, measurevar = "SWdens", groupvars = c("BlockN", "Treatment"))
##Graph of the effects of block number and drug on slow wave density
sw.graph <- summarySE(SWS_data, measurevar = "SWdens", groupvars = c("BlockN", "Treatment"))
sw.graph$Treatment<-ordered(sw.graph$Treatment, c("PLA","MPH","ATM","CIT"))
##Graph with Standard Error
ggplot(sw.graph, aes(x = BlockN, y = SWdens, colour = Treatment)) + geom_point() + geom_line() +  ggtitle("Slow wave density according to block number and treatment") + ylab("Mean Slow Wave Density") + xlab("Block Number")+ geom_ribbon(aes(ymin = SWdens-se, ymax = SWdens+se, fill = Treatment), alpha = .35, linetype = 0) + scale_fill_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77")) + scale_colour_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77"))
##Barplot
sw2.graph <- summarySE(SWS_data, measurevar = "SWdens", groupvars = c( "Treatment"))
sw2.graph$Treatment<-ordered(sw2.graph$Treatment,c("PLA","MPH","ATM","CIT"))
ggplot(data=sw2.graph, aes(x=Treatment, y=SWdens, fill = Treatment)) +
geom_bar(stat="identity") + geom_errorbar(aes(ymin = SWdens-se, ymax = SWdens+se), width = .5, size = .6) + scale_fill_discrete( name = "Treatment", breaks = c("PLA", "MPH", "ATM", "CIT"), labels = c("Placebo", "Methylphenidate", "Atomoxetine", "Citalopram")) + ylab("Mean Slow Wave Density")+ scale_fill_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77")) + coord_cartesian(ylim =c(4, 5))
##Graph with Standard Error
ggplot(sw.graph, aes(x = BlockN, y = SWdens, colour = Treatment)) + geom_point() + geom_line() +  ggtitle("Mean slow wave density according to block number and treatment") + ylab("Mean Slow Wave Density") + xlab("Block Number")+ geom_ribbon(aes(ymin = SWdens-se, ymax = SWdens+se, fill = Treatment), alpha = .35, linetype = 0) + scale_fill_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77")) + scale_colour_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77")) + xmin(1)
##Graph with Standard Error
ggplot(sw.graph, aes(x = BlockN, y = SWdens, colour = Treatment)) + geom_point() + geom_line() +  ggtitle("Mean slow wave density according to block number and treatment") + ylab("Mean Slow Wave Density") + xlab("Block Number")+ geom_ribbon(aes(ymin = SWdens-se, ymax = SWdens+se, fill = Treatment), alpha = .35, linetype = 0) + scale_fill_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77")) + scale_colour_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77"))
##Graph with Standard Error
ggplot(sw.graph, aes(x = BlockN, y = SWdens, colour = Treatment)) + geom_point() + geom_line() +  ggtitle("Mean slow wave density according to block number and treatment") + ylab("Mean Slow Wave Density") + xlab("Block Number")+ geom_ribbon(aes(ymin = SWdens-se, ymax = SWdens+se, fill = Treatment), alpha = .35, linetype = 0) + scale_fill_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77")) + scale_colour_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77")) + scale_x_discrete(1, 10)
##Graph with Standard Error
ggplot(sw.graph, aes(x = BlockN, y = SWdens, colour = Treatment)) + geom_point() + geom_line() +  ggtitle("Mean slow wave density according to block number and treatment") + ylab("Mean Slow Wave Density") + xlab("Block Number")+ geom_ribbon(aes(ymin = SWdens-se, ymax = SWdens+se, fill = Treatment), alpha = .35, linetype = 0) + scale_fill_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77")) + scale_colour_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77")) + scale_x_continuous(1, 10)
##Graph with Standard Error
ggplot(sw.graph, aes(x = BlockN, y = SWdens, colour = Treatment)) + geom_point() + geom_line() +  ggtitle("Mean slow wave density according to block number and treatment") + ylab("Mean Slow Wave Density") + xlab("Block Number")+ geom_ribbon(aes(ymin = SWdens-se, ymax = SWdens+se, fill = Treatment), alpha = .35, linetype = 0) + scale_fill_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77")) + scale_colour_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77"))
##Graph with Standard Error
ggplot(sw.graph, aes(x = BlockN, y = SWdens, colour = Treatment)) + geom_point() + geom_line() +  ggtitle("Mean slow wave density according to block number and treatment") + ylab("Mean Slow Wave Density") + xlab("Block Number")+ geom_ribbon(aes(ymin = SWdens-se, ymax = SWdens+se, fill = Treatment), alpha = .35, linetype = 0) + scale_fill_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77")) + scale_colour_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77")) + scale_x_continuous(breaks = c(1:0))
##Graph with Standard Error
ggplot(sw.graph, aes(x = BlockN, y = SWdens, colour = Treatment)) + geom_point() + geom_line() +  ggtitle("Mean slow wave density according to block number and treatment") + ylab("Mean Slow Wave Density") + xlab("Block Number")+ geom_ribbon(aes(ymin = SWdens-se, ymax = SWdens+se, fill = Treatment), alpha = .35, linetype = 0) + scale_fill_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77")) + scale_colour_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77")) + scale_x_continuous(breaks = c(1:10))
##Graph with Standard Error
ggplot(fa.graph, aes(x = BlockN, y = FA, colour = Treatment)) + geom_point() + geom_line() +  ggtitle("False alarms according to block number and treatment") + ylab("Mean False Alarms") + xlab("Block Number") + xlim(0, 10.5) + ylim(0, 0.011) + geom_ribbon(aes(ymin = FA-se, ymax = FA+se, fill = Treatment), alpha = .35, linetype = 0) + scale_fill_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77")) + scale_colour_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77"))
##Graph with Standard Error
ggplot(fa.graph, aes(x = BlockN, y = FA, colour = Treatment)) + geom_point() + geom_line() +  ggtitle("False alarms according to block number and treatment") + ylab("Mean False Alarms") + xlab("Block Number") + xlim(0, 10.5) + ylim(0, 0.011) + geom_ribbon(aes(ymin = FA-se, ymax = FA+se, fill = Treatment), alpha = .35, linetype = 0) + scale_fill_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77")) + scale_colour_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77")) + scale_x_continuous(breaks = c(1:10))
ggplot(data=fa2.graph, aes(x=Treatment, y=FA, fill = Treatment)) +
geom_bar(stat="identity") + geom_errorbar(aes(ymin = FA-se, ymax = FA+se), width = .4, size = .45) + scale_fill_discrete( name = "Treatment", breaks = c("PLA", "MPH", "ATM", "CIT"), labels = c("Placebo", "Methylphenidate", "Atomoxetine", "Citalopram")) + ylab("Mean False Alarm")+ scale_fill_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77"))
ggplot(data=fa2.graph, aes(x=Treatment, y=FA, fill = Treatment)) +
geom_bar(stat="identity") + geom_errorbar(aes(ymin = FA-se, ymax = FA+se), width = .4, size = .45) + scale_fill_discrete( name = "Treatment", breaks = c("PLA", "MPH", "ATM", "CIT"), labels = c("Placebo", "Methylphenidate", "Atomoxetine", "Citalopram")) + ylab("Mean False Alarm")+ scale_fill_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77")) + scale_y_continous(breaks = c(0:.007))
ggplot(data=fa2.graph, aes(x=Treatment, y=FA, fill = Treatment)) +
geom_bar(stat="identity") + geom_errorbar(aes(ymin = FA-se, ymax = FA+se), width = .4, size = .45) + scale_fill_discrete( name = "Treatment", breaks = c("PLA", "MPH", "ATM", "CIT"), labels = c("Placebo", "Methylphenidate", "Atomoxetine", "Citalopram")) + ylab("Mean False Alarm")+ scale_fill_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77")) + scale_y_continuous(breaks = c(0:.007))
ggplot(data=fa2.graph, aes(x=Treatment, y=FA, fill = Treatment)) +
geom_bar(stat="identity") + geom_errorbar(aes(ymin = FA-se, ymax = FA+se), width = .4, size = .45) + scale_fill_discrete( name = "Treatment", breaks = c("PLA", "MPH", "ATM", "CIT"), labels = c("Placebo", "Methylphenidate", "Atomoxetine", "Citalopram")) + ylab("Mean False Alarm")+ scale_fill_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77")) + scale_y_continuous(breaks = c(0:1))
ggplot(data=fa2.graph, aes(x=Treatment, y=FA, fill = Treatment)) +
geom_bar(stat="identity") + geom_errorbar(aes(ymin = FA-se, ymax = FA+se), width = .4, size = .45) + scale_fill_discrete( name = "Treatment", breaks = c("PLA", "MPH", "ATM", "CIT"), labels = c("Placebo", "Methylphenidate", "Atomoxetine", "Citalopram")) + ylab("Mean False Alarm")+ scale_fill_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77")) + scale_y_continuous(breaks = c(0, 1))
ggplot(data=fa2.graph, aes(x=Treatment, y=FA, fill = Treatment)) +
geom_bar(stat="identity") + geom_errorbar(aes(ymin = FA-se, ymax = FA+se), width = .4, size = .45) + scale_fill_discrete( name = "Treatment", breaks = c("PLA", "MPH", "ATM", "CIT"), labels = c("Placebo", "Methylphenidate", "Atomoxetine", "Citalopram")) + ylab("Mean False Alarm")+ scale_fill_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77")) + scale_y_continuous(breaks = c(0, 2))
ggplot(data=fa2.graph, aes(x=Treatment, y=FA, fill = Treatment)) +
geom_bar(stat="identity") + geom_errorbar(aes(ymin = FA-se, ymax = FA+se), width = .4, size = .45) + scale_fill_discrete( name = "Treatment", breaks = c("PLA", "MPH", "ATM", "CIT"), labels = c("Placebo", "Methylphenidate", "Atomoxetine", "Citalopram")) + ylab("Mean False Alarm")+ scale_fill_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77"))
ggplot(data= miss2.graph, aes(x=Treatment, y=Miss, fill = Treatment)) +
geom_bar(stat="identity") + geom_errorbar(aes(ymin = Miss-se, ymax = Miss+se), width = .35, size = .6)  + scale_fill_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77"))  + labs (title = "Bar Plot of The Mean Misses Per Treatment", y = "Mean Misses")
ggplot(data=sw2.graph, aes(x=Treatment, y=SWdens, fill = Treatment)) +
geom_bar(stat="identity") + geom_errorbar(aes(ymin = SWdens-se, ymax = SWdens+se), width = .5, size = .6) + scale_fill_discrete( name = "Treatment", breaks = c("PLA", "MPH", "ATM", "CIT"), labels = c("Placebo", "Methylphenidate", "Atomoxetine", "Citalopram")) + ylab("Mean Slow Wave Density")+ scale_fill_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77")) + coord_cartesian(ylim =c(4, 5))
ggplot(data=sw2.graph, aes(x=Treatment, y=SWdens, fill = Treatment)) +
geom_bar(stat="identity") + geom_errorbar(aes(ymin = SWdens-se, ymax = SWdens+se), width = .5, size = .6) + scale_fill_discrete( name = "Treatment", breaks = c("PLA", "MPH", "ATM", "CIT"), labels = c("Placebo", "Methylphenidate", "Atomoxetine", "Citalopram")) + ylab("Mean Slow Wave Density")+ scale_fill_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77")) + coord_cartesian(ylim =c(4, 5)) + ggtitle("Mean Slow Wave Density Per Treatment")
ggplot(data=sw2.graph, aes(x=Treatment, y=SWdens, fill = Treatment)) +
geom_bar(stat="identity") + geom_errorbar(aes(ymin = SWdens-se, ymax = SWdens+se), width = .5, size = .6) + scale_fill_discrete( name = "Treatment", breaks = c("PLA", "MPH", "ATM", "CIT"), labels = c("Placebo", "Methylphenidate", "Atomoxetine", "Citalopram")) + ylab("Mean Slow Wave Density")+ scale_fill_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77")) + coord_cartesian(ylim =c(4, 5)) + ggtitle("Mean Slow Wave Density For Each Treatment")
##Graph with Standard Error
ggplot(sw.graph, aes(x = BlockN, y = SWdens, colour = Treatment)) + geom_point() + geom_line() +  ggtitle("Mean Slow Wave Density According To Block Number and Treatment") + ylab("Mean Slow Wave Density") + xlab("Block Number")+ geom_ribbon(aes(ymin = SWdens-se, ymax = SWdens+se, fill = Treatment), alpha = .35, linetype = 0) + scale_fill_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77")) + scale_colour_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77")) + scale_x_continuous(breaks = c(1:10))
##Graph of the effects of block number and drug on slow wave density
sw.graph <- summarySE(SWS_data, measurevar = "SWdens", groupvars = c("BlockN", "Treatment"))
sw.graph$Treatment<-ordered(sw.graph$Treatment, c("PLA","MPH","ATM","CIT"))
##Graph with Standard Error
ggplot(sw.graph, aes(x = BlockN, y = SWdens, colour = Treatment)) + geom_point() + geom_line() +  ggtitle("Mean Slow Wave Density According To Block Number and Treatment") + ylab("Mean Slow Wave Density") + xlab("Block Number")+ geom_ribbon(aes(ymin = SWdens-se, ymax = SWdens+se, fill = Treatment), alpha = .35, linetype = 0) + scale_fill_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77")) + scale_colour_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77")) + scale_x_continuous(breaks = c(1:10))
##Barplot
sw2.graph <- summarySE(SWS_data, measurevar = "SWdens", groupvars = c( "Treatment"))
sw2.graph$Treatment<-ordered(sw2.graph$Treatment,c("PLA","MPH","ATM","CIT"))
ggplot(data=sw2.graph, aes(x=Treatment, y=SWdens, fill = Treatment)) +
geom_bar(stat="identity") + geom_errorbar(aes(ymin = SWdens-se, ymax = SWdens+se), width = .5, size = .6) + scale_fill_discrete( name = "Treatment", breaks = c("PLA", "MPH", "ATM", "CIT"), labels = c("Placebo", "Methylphenidate", "Atomoxetine", "Citalopram")) + ylab("Mean Slow Wave Density")+ scale_fill_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77")) + coord_cartesian(ylim =c(4, 5)) + ggtitle("Mean Slow Wave Density For Each Treatment")
##Graph with Standard Error
ggplot(miss.graph, aes(x = BlockN, y = Miss, colour = Treatment)) + geom_point() + geom_line() + ggtitle("Missed targets according to block number and treatment") + ylab("Mean Missed Targets") + xlab("Block Number") + xlim(0, 11) + ylim(0.1, 0.5) + geom_ribbon(aes(ymin = Miss-se, ymax = Miss+se, fill = Treatment), alpha = .35, linetype = 0) + scale_fill_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77"))  + scale_colour_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77"))
##Graph with Standard Error
ggplot(miss.graph, aes(x = BlockN, y = Miss, colour = Treatment)) + geom_point() + geom_line() + ggtitle("Missed targets according to block number and treatment") + ylab("Mean Missed Targets") + xlab("Block Number") + xlim(0, 11) + ylim(0.1, 0.5) + geom_ribbon(aes(ymin = Miss-se, ymax = Miss+se, fill = Treatment), alpha = .35, linetype = 0) + scale_fill_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77"))  + scale_colour_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77"))+ scale_x_continuous(breaks = c(1:10))
ggplot(miss.graph, aes(x = BlockN, y = Miss, colour = Treatment)) + geom_point() + geom_line() + ggtitle("Missed targets according to block number and treatment") + ylab("Mean Missed Targets") + xlab("Block Number") + xlim(0, 11) + ylim(0.1, 0.5) + geom_ribbon(aes(ymin = Miss-se, ymax = Miss+se, fill = Treatment), alpha = .35, linetype = 0) + scale_fill_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77"))  + scale_colour_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77"))+ scale_x_continuous(breaks = c(1:10))
##Barplot
miss2.graph <- summarySE(CTET_Behaviour1, measurevar = "Miss", groupvars = c("Treatment"), na.rm = TRUE)
miss2.graph$Treatment<-ordered(miss2.graph$Treatment,c("PLA","MPH","ATM","CIT"))
ggplot(data= miss2.graph, aes(x=Treatment, y=Miss, fill = Treatment)) +
geom_bar(stat="identity") + geom_errorbar(aes(ymin = Miss-se, ymax = Miss+se), width = .35, size = .6)  + scale_fill_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77"))  + labs (title = "Bar Plot of The Mean Misses Per Treatment", y = "Mean Misses")
##Graph of the interaction between treatment and block number on hit rates
rt.graph <- summarySE(CTET_Behaviour1, measurevar = "Hit_RT", groupvars = c("BlockN", "Treatment"), na.rm = TRUE)
rt.graph$Treatment<-ordered(rt.graph$Treatment,c("PLA","MPH","ATM","CIT"))
##Reference graph
ggplot(rt.graph, aes(x = BlockN, y = Hit_RT, colour = Treatment)) + geom_point() + geom_line() + scale_colour_brewer(palette = "Dark2") + scale_fill_brewer(palette = "Dark2") + ggtitle("Mean RT for Hits according to block number and treatment") + ylab("Hit Rate") + xlab("Block Number") + xlim(0, 11) + ylim(1.3, 1.5)
##Graph with Standard Error
ggplot(rt.graph, aes(x = BlockN, y = Hit_RT, colour = Treatment)) + geom_point() + geom_line(alpha = .7) +  ggtitle("Mean RT for Hits according to block number and treatment") + ylab("Mean RT Hit") + xlab("Block Number") + xlim(0, 11) + ylim(1.3, 1.5) + geom_ribbon(aes(ymin = Hit_RT-se, ymax = Hit_RT+se, fill = Treatment), alpha = .35, linetype = 0) + scale_fill_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77")) + scale_colour_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77"))+ scale_x_continuous(breaks = c(1:10))
rt2.graph <- summarySE(CTET_Behaviour1, measurevar = "Hit_RT", groupvars = c("Treatment"), na.rm = TRUE)
rt2.graph$Treatment<-ordered(rt2.graph$Treatment,c("PLA","MPH","ATM","CIT"))
ggplot(data= rt2.graph, aes(x=Treatment, y=Hit_RT, fill = Treatment)) +
geom_bar(stat="identity") + geom_errorbar(aes(ymin = Hit_RT-se, ymax = Hit_RT+se), width = .4, size = .5) + scale_fill_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77")) + ylim(0, 2) + labs(title = "Bar Plot of The Mean RT for Hits Per Treatment", y = "Mean RT Hit") + coord_cartesian(ylim =c(1.35, 1.45))
